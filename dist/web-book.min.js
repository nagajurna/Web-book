"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),WebBook=function(){function t(e,i){var n=this;_classCallCheck(this,t),this._bookContainer=e,this._textContainer=e.querySelector("[data-wb-text-container]"),this._text=e.querySelector("[data-wb-text]"),this._height=i.height,this._width=i.maxWidth,this._marginX=void 0===i.marginX?35:i.marginX,this._marginY=void 0===i.marginY?20:i.marginY,this._position=0,this.col=!0,this._bookmark=null,this._containerWidth=null,this._lastBreak=document.createElement("div"),this._lastBreak.className="wb-text-break",this._text.appendChild(this._lastBreak),this._lastElement=document.createElement("div"),this._lastElement.innerHTML="&nbsp;",this._lastElement.className="wb-section wb-no-toc",this._text.appendChild(this._lastElement),this._sections=this._text.querySelectorAll(".wb-section"),this._breaks=this._text.querySelectorAll(".wb-text-break"),this._elements=this._text.querySelectorAll(":not(.wb-text-break)"),this._toc=this._bookContainer.querySelector("[data-wb-toc]"),this.getToc(),this._currentPages=this._bookContainer.querySelectorAll(".wb-current-page"),this._totalPages=this._bookContainer.querySelectorAll(".wb-total-pages"),this._currentTotalPages=this._bookContainer.querySelectorAll(".wb-currentByTotal-pages"),this._elPageNumbers=this._bookContainer.querySelectorAll("[data-wb-element-page-number]"),this._sectionTitles=this._bookContainer.querySelectorAll(".wb-current-section-title"),this._startPage=null,this._endPage=null,this._bookContainer.querySelectorAll(".wb-link").forEach(function(t){t.addEventListener("click",function(t){if(!0===n.col){t.preventDefault();var e=t.target.getAttribute("href").replace(/^#/,"");n.goToPage(n.elementPageNumber(e))}},!1)}),("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style)&&this.toBook()}return _createClass(t,[{key:"toBook",value:function(){if("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style){this.col=!0;var t=this._textContainer.style,e=this._text.style;t.boxSizing="border-box",t.overflow="hidden",t.position="relative",t.left=0,t.top=0,t.padding="0px",t.height=this.getHeight()+"px",t.maxWidth=this.getWidth()+"px",this._containerWidth=this._textContainer.clientWidth;for(var i=0;i<this._sections.length;i++)"10%"!==this._sections[i].style.minHeight&&(this._sections[i].style.minHeight="10%");for(var n=0;n<this._breaks.length;n++)"300%"!==this._breaks[n].style.marginBottom&&(this._breaks[n].style.marginBottom="300%");"300%"!==this._lastElement.style.marginBottom&&(this._lastElement.style.marginBottom="300%"),e.boxSizing="border-box",e.position="absolute",e.left=0,e.top=0,e.height="100%",e.width="100%",e.paddingRight=this.getMarginX()+"px",e.paddingLeft=this.getMarginX()+"px",e.paddingTop=this.getMarginY()+"px",e.paddingBottom=this.getMarginY()+"px",e.MozColumnFill="auto",e.WebkitColumnsWidth=this._containerWidth+"px",e.MozColumnWidth=this._containerWidth+"px",e.columnWidth=this._containerWidth+"px",e.MozColumnGap=2*this.getMarginX()+"px",e.WebkitColumnGap=2*this.getMarginX()+"px",e.columnGap=2*this.getMarginX()+"px",this._bookmark&&(this.goToBookmark(this._bookmark),this._position=this._text.offsetLeft),this.refresh()}}},{key:"toScroll",value:function(){this.col=!1;var t=this._container.style,e=this._text.style;t.height="auto",t.maxWidth=this.getWidth()+"px",t.overflow="visible",e.position="static",e.height="auto",t.paddingRight=this.getMarginX()+"px",t.paddingLeft=this.getMarginX()+"px",t.paddingTop=this.getMarginY()+"px",t.paddingBottom=this.getMarginY()+"px",("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style)&&(e.WebkitColumns="auto 1",e.MozColumns="auto 1",e.columns="auto 1");for(var i=0;i<this._sections.length;i++)this._sections[i].style.minHeight="0";for(var n=0;n<this._breaks.length;n++)this._breaks[n].style.marginBottom="0";this._lastElement.style.marginBottom="0px",this.refresh()}},{key:"setWidth",value:function(t){return this._width=t,this}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){return this._height=t,this}},{key:"getHeight",value:function(){return this._height}},{key:"setMarginX",value:function(t){return this._marginX=t,this}},{key:"getMarginX",value:function(){return this._marginX}},{key:"setMarginY",value:function(t){return this._marginY=t,this}},{key:"getMarginY",value:function(){return this._marginY}},{key:"forward",value:function(){this._lastElement.offsetLeft+this._position>this._containerWidth+this.getMarginX()&&(this._position=this._text.offsetLeft,this._position-=this._containerWidth,this._text.style.left=this._position+"px",this.refresh())}},{key:"backward",value:function(){this._position<0&&(this._position=this._text.offsetLeft,this._position+=this._containerWidth,this._text.style.left=this._position+"px",this.refresh())}},{key:"tofirstPage",value:function(){this._position<0&&(this._position=0,this._text.style.left=this._position+"px",this.refresh())}},{key:"tolastPage",value:function(){this._lastElement.offsetLeft+this._position>this._containerWidth+this.getMarginX()&&(this._position=this._containerWidth+this.getMarginX()-this._lastElement.offsetLeft,this._text.style.left=this._position+"px",this.refresh())}},{key:"getPageScope",value:function(){for(var t=void 0,e=void 0,i=void 0,n=0;n<this._sections.length-1;n++)if(this._sections[n].className.match(/wb-no-page/)){if(e){i=n,this._endPage=this.elementPageNumber(this._sections[i].id),console.log(this._endPage);break}t=n}else t&&!e&&(e=n,this._startPage=this.elementPageNumber(this._sections[e].id),console.log(this._startPage))}},{key:"getPageNumber",value:function(){return Math.abs(Math.floor(this._position/this._containerWidth))+1}},{key:"getTotalPages",value:function(){return Math.floor(this._lastElement.offsetLeft/this._containerWidth)}},{key:"goToPage",value:function(t){t=(t=t<1?1:t)>this.getTotalPages()?this.getTotalPages():t;var e=this._containerWidth*(t-1);this._text.style.left=-e+"px",this._position=this._text.offsetLeft,this.refresh()}},{key:"elementPageNumber",value:function(t){var e=this._text.querySelector("#"+t).offsetLeft-this.getMarginX();return(e=e%this._containerWidth!=0?e-e%this._containerWidth:e)/this._containerWidth+1}},{key:"getSectionTitle",value:function(){for(var t=-this._position,e=void 0,i=1;i<this._sections.length;i++)if(this._sections[i].offsetLeft-this._containerWidth>=t){var n=this._sections[i-1].id;e=void 0!==n&&this.getPageNumber()===this.elementPageNumber(n)?"":this._sections[i-1].getAttribute("data-wb-title");break}return e}},{key:"getToc",value:function(){var t=this;if(this._toc){if(this._toc.getAttribute("data-wb-toc")){var e=document.createElement("p");e.setAttribute("class","wb-toc-title"),e.innerHTML=this._toc.getAttribute("data-wb-toc"),this._toc.appendChild(e)}this._sections.forEach(function(e){if(!e.className.match(/wb-no-toc/)){var i=document.createElement("p");i.innerHTML=e.getAttribute("data-wb-title"),i.setAttribute("class","wb-toc-item");var n=document.createElement("a");n.setAttribute("href","#"+e.id),n.setAttribute("class","wb-link"),n.setAttribute("data-wb-element-page-number",e.id),i.appendChild(n),t._toc.appendChild(i)}})}}},{key:"getTocCurrentSection",value:function(){for(var t=this,e=-this._position,i=1;i<this._sections.length&&!(this._sections[i].offsetLeft-this._containerWidth>=e&&"break"===function(){var e=t._sections[i-1].id;return t._toc.querySelectorAll("a").forEach(function(t){t.getAttribute("href").replace(/^#/,"")===e?t.parentElement.className.match(/current/)||(t.parentElement.className+=" current"):t.parentElement.className.match(/current/)&&(t.parentElement.className=t.parentElement.className.replace(/ current/,""))}),"break"}());i++);}},{key:"insertBookmark",value:function(){for(var t=null,e=0;e<this._elements.length;e++){var i=this._elements[e].offsetLeft-this.getMarginX();if((i=i%this._containerWidth!=0?i-i%this._containerWidth:i)===-this._position){t=e;break}if(i>-this._position){t=e-1;break}}this._bookmark=t}},{key:"goToBookmark",value:function(t){var e=this._elements[this._bookmark].offsetLeft-this.getMarginX();e=e%this._containerWidth!=0?e-e%this._containerWidth:e,this._text.style.left=-e+"px",this._position=this._text.offsetLeft,this.refresh()}},{key:"refresh",value:function(){var t=this;this.insertBookmark(),!1===this.col?(this._currentPages.forEach(function(t){t.innerHTML=""}),this._totalPages.forEach(function(t){t.innerHTML=""}),this._currentTotalPages.forEach(function(t){t.innerHTML=""}),this._elPageNumbers.forEach(function(t){t.innerHTML=""}),this._sectionTitles.forEach(function(t){t.innerHTML=""})):(this.getPageScope(),this._toc&&this.getTocCurrentSection(),this._currentPages.forEach(function(e){e.innerHTML!=t.getPageNumber()&&(e.innerHTML=t.getPageNumber())}),this._totalPages.forEach(function(e){e.innerHTML!=t.getTotalPages()&&(e.innerHTML=t.getTotalPages())}),this._currentTotalPages.forEach(function(e){e.innerHTML!==t.getPageNumber()+"/"+t.getTotalPages()&&(e.innerHTML=t.getPageNumber()+"/"+t.getTotalPages())}),this._elPageNumbers.forEach(function(e){var i=e.getAttribute("data-wb-element-page-number"),n=t.elementPageNumber(i);e.innerHTML!=n&&(e.innerHTML=n)}),this._sectionTitles.forEach(function(e){e.innerHTML!==t.getSectionTitle()&&(e.innerHTML=t.getSectionTitle())}))}}]),t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYi1ib29rLmpzIl0sIm5hbWVzIjpbIldlYkJvb2siLCJib29rQ29udGFpbmVyIiwib3B0aW9ucyIsIl90aGlzIiwidGhpcyIsIl9jbGFzc0NhbGxDaGVjayIsIl9ib29rQ29udGFpbmVyIiwiX3RleHRDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiX3RleHQiLCJfaGVpZ2h0IiwiX3dpZHRoIiwibWF4V2lkdGgiLCJfbWFyZ2luWCIsInVuZGVmaW5lZCIsIm1hcmdpblgiLCJfbWFyZ2luWSIsIm1hcmdpblkiLCJfcG9zaXRpb24iLCJoZWlnaHQiLCJfbGFzdEVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjb2wiLCJjbGFzc05hbWUiLCJfYm9va21hcmsiLCJfc2VjdGlvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2xhc3RCcmVhayIsIl9lbGVtZW50cyIsIl90b3RhbFBhZ2VzIiwiX2JyZWFrcyIsIl9lbFBhZ2VOdW1iZXJzIiwiX3RvYyIsIl9lbmRQYWdlIiwiX2N1cnJlbnRQYWdlcyIsInZhbCIsIl9jdXJyZW50VG90YWxQYWdlcyIsImUiLCJpZCIsIl9zZWN0aW9uVGl0bGVzIiwiZ2V0QXR0cmlidXRlIiwicmVwbGFjZSIsIl9zdGFydFBhZ2UiLCJlbGVtZW50UGFnZU51bWJlciIsImJvZHkiLCJzdHlsZSIsInByZXZlbnREZWZhdWx0IiwiY3MiLCJ0cyIsInRvQm9vayIsImJveFNpemluZyIsIm92ZXJmbG93IiwicG9zaXRpb24iLCJsZWZ0IiwidG9wIiwicGFkZGluZyIsImdldEhlaWdodCIsImNsaWVudFdpZHRoIiwiaSIsImxlbmd0aCIsIm1pbkhlaWdodCIsIl9jb250YWluZXJXaWR0aCIsIm1hcmdpbkJvdHRvbSIsIndpZHRoIiwicGFkZGluZ1JpZ2h0IiwicGFkZGluZ0xlZnQiLCJnZXRNYXJnaW5YIiwicGFkZGluZ1RvcCIsImdldE1hcmdpblkiLCJwYWRkaW5nQm90dG9tIiwiTW96Q29sdW1uRmlsbCIsIldlYmtpdENvbHVtbnNXaWR0aCIsIm9mZnNldExlZnQiLCJXZWJraXRDb2x1bW5HYXAiLCJfY29udGFpbmVyIiwiZ2V0V2lkdGgiLCJjb2x1bW5zIiwiV2Via2l0Q29sdW1ucyIsInJlZnJlc2giLCJ3IiwiaCIsIm0iLCJpbmRleCIsImVuZEluZGV4IiwibWF0Y2giLCJzdGFydEluZGV4IiwiY29uc29sZSIsIk1hdGgiLCJhYnMiLCJmbG9vciIsIm51bWJlciIsImdldFRvdGFsUGFnZXMiLCJlbFBvc2l0aW9uIiwibG9nIiwicGFnZU51bWJlciIsInRpdGxlIiwiZ2V0UGFnZU51bWJlciIsInRvdGFsUGFnZXMiLCJ0b2NUaXRsZSIsInNldEF0dHJpYnV0ZSIsImVsIiwiYXBwZW5kQ2hpbGQiLCJlbFBhZ2VOdW1iZXIiLCJwIiwiYSIsIl90aGlzMiIsIl90aGlzMyIsImZvckVhY2giLCJwYXJlbnRFbGVtZW50IiwiYm9va21hcmsiLCJfdGhpczQiLCJnZXRUb2NDdXJyZW50U2VjdGlvbiIsImVsZW1lbnQiLCJpbnNlcnRCb29rbWFyayIsImdldFNlY3Rpb25UaXRsZSJdLCJtYXBwaW5ncyI6IjZYQUFNQSxtQkFDTCxTQUFBQSxFQUFZQyxFQUFlQyxHQUFTLElBQUFDLEVBQUFDLEtBQUFDLGdCQUFBRCxLQUFBSixHQUVuQ0ksS0FBS0UsZUFBaUJMLEVBQ3RCRyxLQUFLRyxlQUFpQk4sRUFBY08sY0FBYyw0QkFDbERKLEtBQUtLLE1BQVFSLEVBQWNPLGNBQWMsa0JBSjFDSixLQUFBTSxRQUFBUixFQUFZRCxPQUF3QkcsS0FBQU8sT0FBQVQsRUFBQVUsU0FRbkNSLEtBQUtTLGNBQTZCQyxJQUFsQlosRUFBUWEsUUFBc0IsR0FBS2IsRUFBUWEsUUFSeEJYLEtBQUFZLGNBQUFGLElBQUFaLEVBQUFlLFFBQUEsR0FBQWYsRUFBQWUsUUFDbkNiLEtBQUFjLFVBQUEsRUFDQWQsS0FBS0UsS0FBQUEsRUFDTEYsS0FBS0csVUFBQUEsS0FDTEgsS0FBS0ssZ0JBQVFSLEtBRWJHLEtBQUtNLFdBQVVSLFNBQVFpQixjQUF2QixPQUNBZixLQUFLTyxXQUFTVCxVQUFRVSxnQkFDdEJSLEtBQUtTLE1BQUFBLFlBQVdYLEtBQVFhLFlBRXhCWCxLQUFBZ0IsYUFBQUMsU0FBQUMsY0FBQSxPQUNBbEIsS0FBS2MsYUFBTEssVUFBQSxTQUNBbkIsS0FBS29CLGFBQVdDLFVBQUEsdUJBQ2hCckIsS0FBS3NCLE1BQUFBLFlBQUx0QixLQUFBZ0IsY0FFQWhCLEtBQUF1QixVQUFBdkIsS0FBQUssTUFBQW1CLGlCQUFBLGVBRUF4QixLQUFLeUIsUUFBTHpCLEtBQWdCcUIsTUFBaEJHLGlCQUFBLGtCQUVBeEIsS0FBQTBCLFVBQUExQixLQUFBSyxNQUFBbUIsaUJBQUEsd0JBRUF4QixLQUFLZ0IsS0FBQUEsS0FBTGQsZUFBOEJFLGNBQVMsaUJBRXZDSixLQUFLSyxTQUVMTCxLQUFLdUIsY0FBWXZCLEtBQUtLLGVBQU1tQixpQkFBWCxvQkFDakJ4QixLQUFBMkIsWUFBQTNCLEtBQUFFLGVBQUFzQixpQkFBQSxtQkFDQXhCLEtBQUs0QixtQkFBcUJKLEtBQUFBLGVBQWlCQSxpQkFBM0MsNEJBQ0F4QixLQUFBNkIsZUFBQTdCLEtBQUFFLGVBQUFzQixpQkFBQSxpQ0FDQXhCLEtBQUswQixlQUFpQnJCLEtBQUxILGVBQVdzQixpQkFBaUIsNkJBRTdDeEIsS0FBSzhCLFdBQVk1QixLQUNqQkYsS0FBQStCLFNBQUEsS0FFQS9CLEtBQUFFLGVBQUFzQixpQkFBQSxZQUNLUSxRQUFBQSxTQUFBQSxHQUNMQyxFQUFLTixpQkFBYyxRQUFLekIsU0FBQUEsR0FDeEIsSUFBS2dDLElBQUFBLEVBQUFBLElBQUFBLENBQ0xDLEVBQUtOLGlCQUNMLElBQ0FPLEVBREtDLEVBQUFBLE9BQWlCQyxhQUFLcEMsUUFDM0JxQyxRQUFBLEtBQUEsSUFDQXhDLEVBQUt5QyxTQUFMekMsRUFBQTBDLGtCQUFBTCxPQUVBLE1BSUUsc0JBQW9CbkIsU0FBQXlCLEtBQUFDLE9BQUEsbUJBQUExQixTQUFBeUIsS0FBQUMsT0FBQSxnQkFBQTFCLFNBQUF5QixLQUFBQyxRQUNuQlIsS0FBRVMsK0RBTUosR0FURCxzQkFBQTNCLFNBQUF5QixLQUFBQyxPQUFBLG1CQUFBMUIsU0FBQXlCLEtBQUFDLE9BQUEsZ0JBQUExQixTQUFBeUIsS0FBQUMsTUFBQSxDQW9CQzNDLEtBQUtvQixLQUFNLEVBUlosSUFBR3lCLEVBQUE3QyxLQUFBRyxlQUF1QmMsTUFDekI2QixFQUFLQyxLQUFMMUMsTUFBQXNDLE1BR0RFLEVBQUFHLFVBQUEsYUFTQ0gsRUFBR0ksU0FBVyxTQUNkSixFQUFHSyxTQUFXLFdBQ2RMLEVBQUdNLEtBQU8sRUFDVk4sRUFBR08sSUFBTSxFQVRWUCxFQUFBUSxRQUFHLE1BQ0ZSLEVBQUE5QixPQUFXZixLQUFYc0QsWUFBQSxLQUNBVCxFQUFBckMsU0FBU1IsS0FBS0csV0FBZXdDLEtBQzdCM0MsS0FBSThDLGdCQUFnQkgsS0FBcEJ4QyxlQUFBb0QsWUFJQVYsSUFBR0ssSUFBQUEsRUFBQUEsRUFBSE0sRUFBY3hELEtBQUF1QixVQUFka0MsT0FBQUQsSUFDQSxRQUFHTCxLQUFINUIsVUFBQWlDLEdBQUFiLE1BQUFlLFlBQ0FiLEtBQUF0QixVQUFBaUMsR0FBQWIsTUFBQWUsVUFBQSxPQUlBLElBQUEsSUFBS0MsRUFBQUEsRUFBQUEsRUFBQUEsS0FBQUEsUUFBa0JGLE9BQUt0RCxJQVdhLFNBQXJDSCxLQUFLNEIsUUFBUTRCLEdBQUdiLE1BQU1pQixlQVQxQjVELEtBQUE0QixRQUFBNEIsR0FBQWIsTUFBQWlCLGFBQUEsUUFJc0MsU0FBcEM1RCxLQUFLdUIsYUFBYW9CLE1BQU1lLGVBQ3hCMUQsS0FBQWdCLGFBQUEyQixNQUFBaUIsYUFBQSxRQUlEZCxFQUFBRSxVQUFRcEIsYUFDUGtCLEVBQUFJLFNBQUt0QixXQUNMa0IsRUFBQUssS0FBQSxFQUNETCxFQUFBTSxJQUFBLEVBQ0ROLEVBQUEvQixPQUFBLE9BQ0ErQixFQUFBZSxNQUFRN0MsT0FDUDhCLEVBQUFnQixhQUFLOUMsS0FBYTJCLGFBQWxCLEtBQ0FHLEVBQUFpQixZQUFBL0QsS0FBQWdFLGFBQUEsS0FXRGxCLEVBQUdtQixXQUFhakUsS0FBS2tFLGFBQWUsS0FUcENwQixFQUFBcUIsY0FBQW5FLEtBQUFrRSxhQUFBLEtBQ0FwQixFQUFBQSxjQUFlLE9BQ2ZBLEVBQUFBLG1CQUFjOUMsS0FBZDJELGdCQUFBLEtBQ0FiLEVBQUFBLGVBQUE5QyxLQUFBMkQsZ0JBQUEsS0FDQWIsRUFBQUEsWUFBQTlDLEtBQUEyRCxnQkFBQSxLQUNBYixFQUFBQSxhQUFBLEVBQVk5QyxLQUFaZ0UsYUFBQSxLQUNBbEIsRUFBQUEsZ0JBQUEsRUFBQTlDLEtBQUFnRSxhQUFBLEtBQ0FsQixFQUFBQSxVQUF1QmtCLEVBQXBCRixLQUFlRSxhQUFBLEtBR2xCbEIsS0FBR3FCLFlBQ0hyQixLQUFHc0IsYUFBSHBFLEtBQW1Cc0IsV0FDbkJ3QixLQUFHdUIsVUFBQUEsS0FBSGhFLE1BQXdCaUUsWUFJeEJ4QixLQUFHeUIsOENBT0Z2RSxLQUFBb0IsS0FBQSxFQVdGLElBQUl5QixFQUFLN0MsS0FBS3dFLFdBQVc3QixNQVR4QkcsRUFBQTlDLEtBQUFLLE1BQUFzQyxNQUdBRSxFQUFBOUIsT0FBQSxPQUNEOEIsRUFBQXJDLFNBQUFSLEtBQUF5RSxXQUFBLEtBVUE1QixFQUFHSSxTQUFXLFVBRWRILEVBQUdJLFNBQVcsU0FUZEosRUFBQS9CLE9BQUEsT0FXQThCLEVBQUdpQixhQUFlOUQsS0FBS2dFLGFBQWUsS0FWdENuQixFQUFBa0IsWUFBQS9ELEtBQUFnRSxhQUFBLEtBQ0FuQixFQUFBb0IsV0FBY08sS0FBQUEsYUFBZCxLQUNBM0IsRUFBQXNCLGNBQWM5RCxLQUFNc0MsYUFBcEIsTUFFQUUsc0JBQUE1QixTQUFBeUIsS0FBQUMsT0FBQSxtQkFBQTFCLFNBQUF5QixLQUFBQyxPQUFBLGdCQUFBMUIsU0FBQXlCLEtBQUFDLFNBQ0FFLEVBQUdyQyxjQUFnQmlFLFNBQ25CNUIsRUFBR0ksV0FBVyxTQUNkSCxFQUFBNEIsUUFBQSxVQUlBN0IsSUFBR2tCLElBQUFBLEVBQUFBLEVBQUFBLEVBQUgvRCxLQUFpQnVCLFVBQUt5QyxPQUFlUixJQUNyQ1gsS0FBR29CLFVBQUhULEdBQWdCYixNQUFLdUIsVUFBZSxJQUdwQyxJQUFBLElBQUdWLEVBQUEsRUFBQUEsRUFBQXhELEtBQUE0QixRQUF1QlgsT0FBQUEsSUFDekI2QixLQUFHNkIsUUFBQUEsR0FBQUEsTUFBZ0JmLGFBQW5CLElBR0E1RCxLQUFBZ0IsYUFBQTJCLE1BQUFpQixhQUFBLE1BRUQ1RCxLQUFBNEUsMkNBR0NDLEdBRUQsT0FEQTdFLEtBQUFPLE9BQUFzRSxFQUNJN0Usd0NBSUosT0FBS2dCLEtBQUFBLHlDQUdMOEQsR0FhQSxPQURBOUUsS0FBS00sUUFBVXdFLEVBQ1I5RSx5Q0FSUCxPQUFBQSxLQUFBTSwyQ0FlVXlFLEdBWFYsT0FEQS9FLEtBQUFTLFNBQVlGLEVBQ1pQLDBDQUdBLE9BQUtNLEtBQUFBLDRDQWlCS3lFLEdBRVYsT0FEQS9FLEtBQUtZLFNBQVdtRSxFQUNUL0UsMENBSVAsT0FBT0EsS0FBS1ksMkNBWlpaLEtBQUFnQixhQUFBc0QsV0FBQXRFLEtBQUFjLFVBQUFkLEtBQUEyRCxnQkFBQTNELEtBQUFnRSxlQWtCQ2hFLEtBQUtjLFVBQVlkLEtBQUtLLE1BQU1pRSxXQUM1QnRFLEtBQUtjLFdBQWFkLEtBQUsyRCxnQkFoQnhCM0QsS0FBQUssTUFBT3NDLE1BQUtsQyxLQUFaVCxLQUFBYyxVQUFBLEtBSUFkLEtBQUtZLDhDQXVCRlosS0FBS2MsVUFBWSxJQWxCcEJkLEtBQUFjLFVBQVlGLEtBQVpQLE1BQUFpRSxXQUNBdEUsS0FBQWMsV0FBQWQsS0FBQTJELGdCQW9CQzNELEtBQUtLLE1BQU1zQyxNQUFNUSxLQUFPbkQsS0FBS2MsVUFBWSxLQUN6Q2QsS0FBSzRFLGlEQWZMNUUsS0FBS2MsVUFBYSxJQUNsQmQsS0FBQWMsVUFBQSxFQXFCQWQsS0FBS0ssTUFBTXNDLE1BQU1RLEtBQU9uRCxLQUFLYyxVQUFZLEtBbkJ6Q2QsS0FBQTRFLGdEQUtENUUsS0FBQWdCLGFBQUFzRCxXQUFBdEUsS0FBQWMsVUFBQWQsS0FBQTJELGdCQUFBM0QsS0FBQWdFLGVBcUJDaEUsS0FBS2MsVUFBWWQsS0FBSzJELGdCQUFnQjNELEtBQUtnRSxhQUFhaEUsS0FBS2dCLGFBQWFzRCxXQUMxRXRFLEtBQUtLLE1BQU1zQyxNQUFNUSxLQUFPbkQsS0FBS2MsVUFBVSxLQUN2Q2QsS0FBSzRFLGtEQWZMLElBQUEsSUFEQUksT0FBQUEsRUFBS0osT0FBQUEsRUFBTEssT0FBQUEsRUFDQXpCLEVBQUEsRUFBQUEsRUFBQXhELEtBQUF1QixVQUFBa0MsT0FBQSxFQUFBRCxJQUNELEdBQUF4RCxLQUFBdUIsVUFBQWlDLEdBQUFuQyxVQUFBNkQsTUFBQSxjQUFBLENBc0JFLEdBQUdDLEVBQVksQ0FDZEYsRUFBV3pCLEVBQ1h4RCxLQUFLK0IsU0FBVy9CLEtBQUt5QyxrQkF0Qlh6QyxLQUFBdUIsVUFBQTBELEdBQUE3QyxJQUNiZ0QsUUFBUXRFLElBQUFBLEtBQUxpQixVQUNGLE1BRUFpRCxFQUFLSixPQXlCREksSUFBVUcsSUFDWkEsRUFBYTNCLEVBQ2J4RCxLQUFLd0MsV0FBYXhDLEtBQUt5QyxrQkF2QmR6QyxLQUFBdUIsVUFBQTRELEdBQUEvQyxJQUNaZ0QsUUFBUXBFLElBQUFBLEtBQUFBLHFEQStCUixPQURpQnFFLEtBQUtDLElBQUlELEtBQUtFLE1BQU12RixLQUFLYyxVQUFVZCxLQUFLMkQsa0JBQWtCLDBDQXBCMUUsT0FEWUgsS0FBRytCLE1BQUtoRSxLQUFBQSxhQUFyQitDLFdBQThDdEUsS0FBQTJELGtEQUkzQzZCLEdBRUFBLEdBREFKLEVBQUFBLEVBQVksRUFBS3JELEVBQUFBLEdBQ2pCL0IsS0FBQXlGLGdCQUFBekYsS0FBQXlGLGdCQUFBRCxFQUNBLElBTER0QyxFQUtPbEQsS0FBQTJELGlCQUFBNkIsRUFBQSxHQUNOUixLQUFBQSxNQUFBQSxNQUFBN0IsTUFBQUQsRUFBQSxLQUNBbEQsS0FBQWMsVUFBQWQsS0FBQUssTUFBQWlFLFdBQ0R0RSxLQVRENEUsb0RBWU9wQyxHQUNMNEMsSUFDQU0sRUFEQU4sS0FBUU8sTUFBSXZGLGNBQVosSUFBQWdDLEdBQ0FrQyxXQUFBdEUsS0FBQWdFLGFBR0gsT0FGRTBCLEVBQUFBLEVBQUExRixLQUFBMkQsaUJBQUEsRUFBQStCLEVBQUFBLEVBQUExRixLQUFBMkQsZ0JBQUErQixHQUNEMUYsS0FBQTJELGdCQUFBLDRDQU1ELElBQUEsSUFGQVQsR0FBSTBDLEtBQWFQLFVBQ2pCUSxPQUFBQSxFQUNBckMsRUFBQSxFQUFBQSxFQUFBeEQsS0FBQXVCLFVBQUFrQyxPQUFBRCxJQTRCQyxHQUFHeEQsS0FBS3VCLFVBQVVpQyxHQUFHYyxXQUFXdEUsS0FBSzJELGlCQUFpQlQsRUFBVSxDQUMvRCxJQUFJZCxFQUFLcEMsS0FBS3VCLFVBQVVpQyxFQUFFLEdBQUdwQixHQTFCL0J5RCxPQTJCVW5GLElBQUwwQixHQUFrQnBDLEtBQUs4RixrQkE1QmI5RixLQUFBeUMsa0JBQUFMLEdBQ1gyRCxHQUVKL0YsS0FBQXVCLFVBQUFpQyxFQUFBLEdBQUFsQixhQUFBLGlCQThCRSxNQTFCRmtELE9BQUFBLG1DQUdLMUUsSUFBQUEsRUFBQUEsS0FDTCxHQUFBZCxLQUFLNEUsS0FBTCxDQUNBLEdBQUE1RSxLQUFBOEIsS0FBQVEsYUFBQSxlQUFBLENBOEJDLElBQUkwRCxFQUFXL0UsU0FBU0MsY0FBYyxLQUN0QzhFLEVBQVNDLGFBQWEsUUFBUSxnQkFDOUJELEVBQVM3RSxVQUFZbkIsS0FBSzhCLEtBQUtRLGFBOUJYLGVBQ3JCdEMsS0FBSWtHLEtBQUtDLFlBQVcvRixHQUVwQnNGLEtBQUFBLFVBQWNBLFFBQUFBLFNBQUFBLEdBQ2QsSUFBSVUsRUFBQUEsVUFBQUEsTUFBZVYsYUFBZ0IvQixDQUNuQyxJQUFBMEMsRUFBT0QsU0FBQUEsY0FBUCxLQUNBQyxFQUFBbEYsVUFBQWMsRUFBQUssYUFBQSxpQkErQkUrRCxFQUFFSixhQUFhLFFBQVEsZUFDdkIsSUFBSUssRUFBSXJGLFNBQVNDLGNBQWMsS0FDL0JvRixFQUFFTCxhQUFhLE9BQVEsSUFBTWhFLEVBL0JkRyxJQUNqQmtFLEVBQUFMLGFBQWdCLFFBQUtuRixXQUNyQndGLEVBQUFMLGFBQUlKLDhCQUFKNUQsRUFBQUcsSUFDQWlFLEVBQUFGLFlBQUFHLEdBQ0NDLEVBQUd6RSxLQUFLUCxZQUFhK0Msc0RBT3BCLElBQUEsSUFGYy9DLEVBQUFBLEtBQ2IyQixHQUFBbEQsS0FBQWMsVUFDRDBDLEVBQUEsRUFBQUEsRUFBQXhELEtBQUF1QixVQUFBa0MsVUFDQXpELEtBQUF1QixVQUFBaUMsR0FBQWMsV0FBQXRFLEtBQUEyRCxpQkFBQVQsR0FBQSxVQUFBLFdBQ0QsSUFBQWQsRUFBQW9FLEVBQUFqRixVQUFBaUMsRUFBQSxHQUFBcEIsR0FPQSxPQU5Eb0UsRUFBQTFFLEtBQU8rRCxpQkFBUCxLQUFBWSxRQUFBLFNBQUF4RSxHQUNBQSxFQUFBSyxhQUFBLFFBQUFDLFFBQUEsS0FBQSxNQUFBSCxFQWdDUUgsRUFBSXlFLGNBQWNyRixVQUFVNkQsTUFBTSxhQUNyQ2pELEVBQUl5RSxjQUFjckYsV0FBVyxZQUczQlksRUFBSXlFLGNBQWNyRixVQUFVNkQsTUFBTSxhQWpDdENqRCxFQUFDeUUsY0FBV3JGLFVBQUFZLEVBQUF5RSxjQUFBckYsVUFBQWtCLFFBQUEsV0FBQSxPQUVkLFFBUkMsSUFEQWlCLCtDQWdCQSxJQUFBLElBRERtRCxFQUFRdEYsS0FDSGdGLEVBQUFBLEVBQUlwRixFQUFBQSxLQUFTQyxVQUFBQSxPQUFqQnNDLElBQUEsQ0FDQTZDLElBQUVsRixFQUFZYyxLQUFJSyxVQUFKa0IsR0FBaUJjLFdBQUF0RSxLQUEvQmdFLGFBRUEsSUFEQXFDLEVBQUVKLEVBQUZqRyxLQUF1QjJELGlCQUF2QixFQUFBK0IsRUFBQUEsRUFBQTFGLEtBQUEyRCxnQkFBQStCLE1BQ2lCeEUsS0FBQUEsVUFDakJvRixDQUNBQSxFQUFFTCxFQUNGSyxNQUVBLEdBQUFaLEdBQVVTLEtBQVZyRixVQUNBLENBWEY2RixFQUFBbkQsRUFBQSxFQWFBLE9BdUNBeEQsS0FBS3NCLFVBQVlxRix1Q0FwQ2J6RCxHQUNKLElBQ2lFQSxFQUR2RGxELEtBQUd3RCxVQUFPakMsS0FBQUEsV0FDNkMrQyxXQUFBdEUsS0FBQWdFLGFBQy9EZCxFQUFJZCxFQUFVYixLQUFBQSxpQkFBZCxFQUFBMkIsRUFBQUEsRUFBQWxELEtBQUEyRCxnQkFBQVQsRUFFQ2xELEtBQUFLLE1BQUc0QixNQUFJSyxNQUFKWSxFQUF5QlgsS0FDM0J2QyxLQUFBYyxVQUFRNEYsS0FBQUEsTUFBSnBDLFdBQ0hyQyxLQUFBQSw0Q0FHRCxJQUFBMkUsRUFBQTVHLEtBQ0NpQyxLQUFBQSxrQkFFRCxJQUFBakMsS0FBQW9CLEtBRUZwQixLQUFBZ0MsY0FBQXlFLFFBQUEsU0FBQXhFLEdBYitEQSxFQUFBZCxVQUFBLEtBYy9EbkIsS0FBQTJCLFlBQUE4RSxRQUFBLFNBQUF4RSxHQUNEQSxFQUFBZCxVQUFBLEtBOENBbkIsS0FBS2tDLG1CQUFtQnVFLFFBQVMsU0FBQXhFLEdBQ2hDQSxFQUFJZCxVQUFZLEtBekNqQm5CLEtBQUkwRixlQUFhZSxRQUFLL0UsU0FBQUEsR0FDdEJnRSxFQUFBQSxVQUFjQSxLQUliMUYsS0FBQXFDLGVBQUFvRSxRQUFBLFNBQUF4RSxHQUNBQSxFQUpEZCxVQUtRdUUsT0FNVDFGLEtBQUtzQixlQTJDRHRCLEtBQUs4QixNQUNQOUIsS0FBSzZHLHVCQXZDUDdHLEtBQUFnQyxjQUFBeUUsUUFBQSxTQUFBeEUsR0FDSWlCLEVBQUFBLFdBQVc0RCxFQUFReEMsa0JBQ3ZCcEIsRUFBQUEsVUFBWUEsRUFBUzRDLG1CQUlyQjlGLEtBQUs0RSxZQUFMNkIsUUFBQSxTQUFBeEUsR0FDQUEsRUFBQWQsV0FBQXlGLEVBQUFuQixrQkEyQ0d4RCxFQUFJZCxVQUFZeUYsRUFBS25CLG1CQUl2QnpGLEtBQUtrQyxtQkFBbUJ1RSxRQUFTLFNBQUF4RSxHQTVDbENBLEVBQUs4RSxZQUFMSCxFQUFBZCxnQkFBQSxJQUFBYyxFQUFBbkIsa0JBOENHeEQsRUFBSWQsVUFBWXlGLEVBQUtkLGdCQUFrQixJQUFNYyxFQUFLbkIsbUJBekNuRHhELEtBQUFBLGVBQUF3RSxRQUFBLFNBQUF4RSxHQUNBLElBRkRHLEVBQUFILEVBQUFLLGFBQUEsK0JBZ0RLc0QsRUFBYWdCLEVBQUtuRSxrQkFBa0JMLEdBNUN6Q0gsRUFBS04sV0FBWThFLElBQ2hCeEUsRUFBSWQsVUFBWXlFLEtBSWhCM0QsS0FBQUEsZUFBQXdFLFFBQUEsU0FBQXhFLEdBRERBLEVBQUFkLFlBQUF5RixFQUFBSSxvQkFnREUvRSxFQUFJZCxVQUFZeUYsRUFBS0kiLCJmaWxlIjoid2ViLWJvb2subWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgV2ViQm9vayB7XG5cdGNvbnN0cnVjdG9yKGJvb2tDb250YWluZXIsIG9wdGlvbnMpIHtcblx0XHQvL2NvbnRhaW5lcnNcblx0XHR0aGlzLl9ib29rQ29udGFpbmVyID0gYm9va0NvbnRhaW5lcjtcblx0XHR0aGlzLl90ZXh0Q29udGFpbmVyID0gYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS13Yi10ZXh0LWNvbnRhaW5lcl0nKTtcblx0XHR0aGlzLl90ZXh0ID0gYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS13Yi10ZXh0XScpO1xuXHRcdC8vb3B0aW9uc1xuXHRcdHRoaXMuX2hlaWdodCA9IG9wdGlvbnMuaGVpZ2h0O1xuXHRcdHRoaXMuX3dpZHRoID0gb3B0aW9ucy5tYXhXaWR0aDtcblx0XHR0aGlzLl9tYXJnaW5YID0gb3B0aW9ucy5tYXJnaW5YPT09dW5kZWZpbmVkID8gMzUgOiBvcHRpb25zLm1hcmdpblg7XG5cdFx0dGhpcy5fbWFyZ2luWSA9IG9wdGlvbnMubWFyZ2luWT09PXVuZGVmaW5lZCA/IDIwIDogb3B0aW9ucy5tYXJnaW5ZO1xuXHRcdC8vaW5pdCBwb3NpdGlvbiwgY29sICxjb250YWluZXJXaWR0aCBhbmQgYm9va21hcmtcblx0XHR0aGlzLl9wb3NpdGlvbiA9IDA7XG5cdFx0dGhpcy5jb2wgPSB0cnVlOy8vZGVmYXVsdCB0cnVlID0gdG9Cb29rKClcblx0XHR0aGlzLl9ib29rbWFyayA9IG51bGw7XG5cdFx0dGhpcy5fY29udGFpbmVyV2lkdGggPSBudWxsO1xuXHRcdC8vdGhpcy5sYXN0QnJlYWsgaXMgdXNlZCBhcyBhIGdob3N0IHBhZ2Vcblx0XHR0aGlzLl9sYXN0QnJlYWsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuX2xhc3RCcmVhay5jbGFzc05hbWUgPSBcIndiLXRleHQtYnJlYWtcIjtcblx0XHR0aGlzLl90ZXh0LmFwcGVuZENoaWxkKHRoaXMuX2xhc3RCcmVhayk7XG5cdFx0Ly90aGlzLl9sYXN0RWxlbWVudCBpcyB1c2VkIGFzIGxhbmRtYXJrXG5cdFx0dGhpcy5fbGFzdEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuX2xhc3RFbGVtZW50LmlubmVySFRNTCA9IFwiJm5ic3A7XCI7Ly9ub3QgZW1wdHkgKGZvciBtb3pDb2x1bW5zKVxuXHRcdHRoaXMuX2xhc3RFbGVtZW50LmNsYXNzTmFtZSA9IFwid2Itc2VjdGlvbiB3Yi1uby10b2NcIjtcblx0XHR0aGlzLl90ZXh0LmFwcGVuZENoaWxkKHRoaXMuX2xhc3RFbGVtZW50KTtcblx0XHQvL3NlY3Rpb25zXG5cdFx0dGhpcy5fc2VjdGlvbnMgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1zZWN0aW9uJyk7XG5cdFx0Ly9icmVha3Ncblx0XHR0aGlzLl9icmVha3MgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi10ZXh0LWJyZWFrJyk7XG5cdFx0Ly9lbGVtZW50cyA6IHNlbGVjdCBhbGwgZWxlbWVudHMgYnV0IC50ZXh0LWJyZWFrcyAoZm9yIGJvb2ttYXJrcylcblx0XHR0aGlzLl9lbGVtZW50cyA9IHRoaXMuX3RleHQucXVlcnlTZWxlY3RvckFsbCgnOm5vdCgud2ItdGV4dC1icmVhayknKTtcblx0XHQvL3RvY1xuXHRcdHRoaXMuX3RvYyA9IHRoaXMuX2Jvb2tDb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtd2ItdG9jXScpO1xuXHRcdC8vc2V0VG9jIGJlZm9yZSBxdWVyeWluZyB0aGlzLmVsUGFnZU51bWJlcnNcblx0XHR0aGlzLmdldFRvYygpO1xuXHRcdC8vaW5mb3MgY29udGFpbmVyc1xuXHRcdHRoaXMuX2N1cnJlbnRQYWdlcyA9IHRoaXMuX2Jvb2tDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLndiLWN1cnJlbnQtcGFnZScpO1xuXHRcdHRoaXMuX3RvdGFsUGFnZXMgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi10b3RhbC1wYWdlcycpO1xuXHRcdHRoaXMuX2N1cnJlbnRUb3RhbFBhZ2VzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcud2ItY3VycmVudEJ5VG90YWwtcGFnZXMnKTtcblx0XHR0aGlzLl9lbFBhZ2VOdW1iZXJzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS13Yi1lbGVtZW50LXBhZ2UtbnVtYmVyXScpO1xuXHRcdHRoaXMuX3NlY3Rpb25UaXRsZXMgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1jdXJyZW50LXNlY3Rpb24tdGl0bGUnKTtcblx0XHQvL3N0YXJ0L2VuZCBwYWdpbmF0aW9uXG5cdFx0dGhpcy5fc3RhcnRQYWdlID0gbnVsbDtcblx0XHR0aGlzLl9lbmRQYWdlID0gbnVsbDtcblx0XHQvL2xpbmtzIDogcmVwbGFjZSBkZWZhdWx0IHdpdGggZ29Ub1BhZ2Vcblx0XHRsZXQgbGlua3MgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1saW5rJyk7XG5cdFx0bGlua3MuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdHZhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdFx0XHRpZih0aGlzLmNvbD09PXRydWUpIHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0bGV0IGhyZWYgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcblx0XHRcdFx0XHRsZXQgaWQgPSBocmVmLnJlcGxhY2UoL14jLyxcIlwiKTtcblx0XHRcdFx0XHR0aGlzLmdvVG9QYWdlKHRoaXMuZWxlbWVudFBhZ2VOdW1iZXIoaWQpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgZmFsc2UpO1xuXHRcdH0pXG5cdFx0XG5cdFx0XG5cdFx0aWYoJ1dlYmtpdENvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdNb3pDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnY29sdW1uV2lkdGgnIGluIGRvY3VtZW50LmJvZHkuc3R5bGUpIHtcblx0XHRcdHRoaXMudG9Cb29rKCk7XG5cdFx0fVxuXG5cdH1cblxuXHR0b0Jvb2soKSB7XG5cdFx0aWYoJ1dlYmtpdENvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdNb3pDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnY29sdW1uV2lkdGgnICBpbiBkb2N1bWVudC5ib2R5LnN0eWxlKSB7XG5cdFx0XHR0aGlzLmNvbCA9IHRydWU7XG5cdFx0XHRsZXQgY3MgPSB0aGlzLl90ZXh0Q29udGFpbmVyLnN0eWxlO1xuXHRcdFx0bGV0IHRzID0gdGhpcy5fdGV4dC5zdHlsZTtcblx0XHRcdC8vdGV4dC1jb250YWluZXJcblx0XHRcdGNzLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRcdFx0Y3Mub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuXHRcdFx0Y3MucG9zaXRpb24gPSBcInJlbGF0aXZlXCI7XG5cdFx0XHRjcy5sZWZ0ID0gMDtcblx0XHRcdGNzLnRvcCA9IDA7XG5cdFx0XHRjcy5wYWRkaW5nID0gXCIwcHhcIjtcblx0XHRcdGNzLmhlaWdodCA9IHRoaXMuZ2V0SGVpZ2h0KCkgKyBcInB4XCI7XG5cdFx0XHRjcy5tYXhXaWR0aCA9IHRoaXMuZ2V0V2lkdGgoKSArIFwicHhcIjsvL21heFdpZHRoIDogcmVzcG9uc2l2ZVxuXHRcdFx0dGhpcy5fY29udGFpbmVyV2lkdGggPSB0aGlzLl90ZXh0Q29udGFpbmVyLmNsaWVudFdpZHRoOy8vcmVzcG9uc2l2ZVxuXHRcdFx0XG5cdFx0XHQvL3NlY3Rpb25zXG5cdFx0XHQvL2hhY2sgZmlyZWZveCAocG91ciBvZmZzZXRMZWZ0KSA6IG1pbkhlaWdodCA9IDEwJVxuXHRcdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYodGhpcy5fc2VjdGlvbnNbaV0uc3R5bGUubWluSGVpZ2h0IT09XCIxMCVcIikge1xuXHRcdFx0XHRcdHRoaXMuX3NlY3Rpb25zW2ldLnN0eWxlLm1pbkhlaWdodCA9IFwiMTAlXCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdC8vbWFudWFsIGJyZWFrc1xuXHRcdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fYnJlYWtzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmKHRoaXMuX2JyZWFrc1tpXS5zdHlsZS5tYXJnaW5Cb3R0b20hPT1cIjMwMCVcIikge1xuXHRcdFx0XHRcdHRoaXMuX2JyZWFrc1tpXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjMwMCVcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly9sYXN0IGVsZW1lbnRcblx0XHRcdGlmKHRoaXMuX2xhc3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSE9PVwiMzAwJVwiKSB7XG5cdFx0XHRcdHRoaXMuX2xhc3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMzAwJVwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvL3RleHRcblx0XHRcdHRzLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRcdFx0dHMucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cdFx0XHR0cy5sZWZ0ID0gMDtcblx0XHRcdHRzLnRvcCA9IDA7XG5cdFx0XHR0cy5oZWlnaHQgPSBcIjEwMCVcIjtcblx0XHRcdHRzLndpZHRoID0gXCIxMDAlXCI7XG5cdFx0XHR0cy5wYWRkaW5nUmlnaHQgPSB0aGlzLmdldE1hcmdpblgoKSArIFwicHhcIjtcblx0XHRcdHRzLnBhZGRpbmdMZWZ0ID0gdGhpcy5nZXRNYXJnaW5YKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5wYWRkaW5nVG9wID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5wYWRkaW5nQm90dG9tID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5Nb3pDb2x1bW5GaWxsID0gXCJhdXRvXCI7Ly9pbXBvcnRhbnQgISEhXG5cdFx0XHR0cy5XZWJraXRDb2x1bW5zV2lkdGggPSB0aGlzLl9jb250YWluZXJXaWR0aCArIFwicHhcIjtcblx0XHRcdHRzLk1vekNvbHVtbldpZHRoID0gdGhpcy5fY29udGFpbmVyV2lkdGggKyBcInB4XCI7XG5cdFx0XHR0cy5jb2x1bW5XaWR0aCA9IHRoaXMuX2NvbnRhaW5lcldpZHRoICsgXCJweFwiO1xuXHRcdFx0dHMuTW96Q29sdW1uR2FwID0gdGhpcy5nZXRNYXJnaW5YKCkqMiArIFwicHhcIjtcblx0XHRcdHRzLldlYmtpdENvbHVtbkdhcCA9IHRoaXMuZ2V0TWFyZ2luWCgpKjIgKyBcInB4XCI7XG5cdFx0XHR0cy5jb2x1bW5HYXAgPSB0aGlzLmdldE1hcmdpblgoKSoyICsgXCJweFwiO1xuXHRcdFx0XG5cdFx0XHQvL0dvIHRvIGJvb2ttYXJrXG5cdFx0XHRpZih0aGlzLl9ib29rbWFyaykge1xuXHRcdFx0XHR0aGlzLmdvVG9Cb29rbWFyayh0aGlzLl9ib29rbWFyayk7XG5cdFx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fdGV4dC5vZmZzZXRMZWZ0O1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvL1JlZnJlc2ggaW5mbyBjb250YWluZXJzXG5cdFx0XHR0aGlzLnJlZnJlc2goKTtcblx0XHRcdFxuXHRcdH1cblx0fVxuXG5cdHRvU2Nyb2xsKCkge1xuXHRcdCd1c2Ugc3RyaWN0Jztcblx0XHR0aGlzLmNvbCA9IGZhbHNlO1xuXHRcdGxldCBjcyA9IHRoaXMuX2NvbnRhaW5lci5zdHlsZTtcblx0XHRsZXQgdHMgPSB0aGlzLl90ZXh0LnN0eWxlO1xuXHRcdC8vY29udGFpbmVyXG5cdFx0Y3MuaGVpZ2h0ID0gXCJhdXRvXCI7XG5cdFx0Y3MubWF4V2lkdGggPSB0aGlzLmdldFdpZHRoKCkgKyBcInB4XCI7XG5cdFx0Y3Mub3ZlcmZsb3cgPSBcInZpc2libGVcIjtcblx0XHQvL3RleHRcblx0XHR0cy5wb3NpdGlvbiA9IFwic3RhdGljXCI7XG5cdFx0dHMuaGVpZ2h0ID0gXCJhdXRvXCI7XG5cdFx0Y3MucGFkZGluZ1JpZ2h0ID0gdGhpcy5nZXRNYXJnaW5YKCkgKyBcInB4XCI7XG5cdFx0Y3MucGFkZGluZ0xlZnQgPSB0aGlzLmdldE1hcmdpblgoKSArIFwicHhcIjtcblx0XHRjcy5wYWRkaW5nVG9wID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cdFx0Y3MucGFkZGluZ0JvdHRvbSA9IHRoaXMuZ2V0TWFyZ2luWSgpICsgXCJweFwiO1xuXG5cdFx0aWYoJ1dlYmtpdENvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdNb3pDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnY29sdW1uV2lkdGgnICBpbiBkb2N1bWVudC5ib2R5LnN0eWxlKSB7XG5cdFx0XHR0cy5XZWJraXRDb2x1bW5zID0gXCJhdXRvIDFcIjtcblx0XHRcdHRzLk1vekNvbHVtbnMgPSBcImF1dG8gMVwiO1xuXHRcdFx0dHMuY29sdW1ucyA9IFwiYXV0byAxXCI7XG5cdFx0fVxuXG5cdFx0Ly9TZWN0aW9ucyAoZm9yIG1vekNvbHVtbnMpXG5cdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRoaXMuX3NlY3Rpb25zW2ldLnN0eWxlLm1pbkhlaWdodCA9IFwiMFwiO1xuXHRcdH1cblx0XHQvL21hbnVhbCBicmVha3Ncblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9icmVha3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRoaXMuX2JyZWFrc1tpXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjBcIjtcblx0XHR9XG5cdFx0Ly9sYXN0IGVsZW1lbnRcblx0XHR0aGlzLl9sYXN0RWxlbWVudC5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjBweFwiO1xuXG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cdH07XG5cblx0c2V0V2lkdGgodykge1xuXHRcdHRoaXMuX3dpZHRoID0gdztcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGdldFdpZHRoKCkge1xuXHRcdHJldHVybiB0aGlzLl93aWR0aDtcblx0fVxuXG5cdHNldEhlaWdodChoKSB7XG5cdFx0dGhpcy5faGVpZ2h0ID0gaDtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGdldEhlaWdodCgpIHtcblx0XHRyZXR1cm4gdGhpcy5faGVpZ2h0O1xuXHR9XG5cblx0c2V0TWFyZ2luWChtKSB7XG5cdFx0dGhpcy5fbWFyZ2luWCA9IG07XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRnZXRNYXJnaW5YKCkge1xuXHRcdHJldHVybiB0aGlzLl9tYXJnaW5YO1xuXHR9XG5cblx0c2V0TWFyZ2luWShtKSB7XG5cdFx0dGhpcy5fbWFyZ2luWSA9IG07XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRnZXRNYXJnaW5ZKCkge1xuXHRcdHJldHVybiB0aGlzLl9tYXJnaW5ZO1xuXHR9XG5cblx0Zm9yd2FyZCgpIHtcblx0XHRpZih0aGlzLl9sYXN0RWxlbWVudC5vZmZzZXRMZWZ0K3RoaXMuX3Bvc2l0aW9uID4gdGhpcy5fY29udGFpbmVyV2lkdGgrdGhpcy5nZXRNYXJnaW5YKCkpIHtcblx0XHRcdC8vbGV0IGNsb25lID0gdGhpcy5fdGV4dC5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0XHR0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3RleHQub2Zmc2V0TGVmdDtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uIC09IHRoaXMuX2NvbnRhaW5lcldpZHRoO1xuXHRcdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gdGhpcy5fcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0XHRcblx0XHRcdC8vY29uc29sZS5sb2coY2xvbmUpO1xuXHRcdFx0Ly9jbG9uZS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblx0XHRcdC8vdGhpcy5fY29udGFpbmVyLmluc2VydEJlZm9yZShjbG9uZSx0aGlzLnRleHQpO1xuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0fVxuXHR9XG5cblx0YmFja3dhcmQoKSB7XG5cdFx0aWYodGhpcy5fcG9zaXRpb24gPCAwKSB7XG5cdFx0XHR0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3RleHQub2Zmc2V0TGVmdDtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uICs9IHRoaXMuX2NvbnRhaW5lcldpZHRoO1xuXHRcdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gdGhpcy5fcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0XHR0aGlzLnJlZnJlc2goKTtcblx0XHR9XG5cdH1cblxuXHR0b2ZpcnN0UGFnZSgpIHtcblx0XHRpZih0aGlzLl9wb3NpdGlvbiA8IDApIHtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gMDtcblx0XHRcdHRoaXMuX3RleHQuc3R5bGUubGVmdCA9IHRoaXMuX3Bvc2l0aW9uICsgXCJweFwiO1xuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0fVxuXHR9XG5cblx0dG9sYXN0UGFnZSgpIHtcblx0XHRpZih0aGlzLl9sYXN0RWxlbWVudC5vZmZzZXRMZWZ0K3RoaXMuX3Bvc2l0aW9uID4gdGhpcy5fY29udGFpbmVyV2lkdGgrdGhpcy5nZXRNYXJnaW5YKCkpIHtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fY29udGFpbmVyV2lkdGgrdGhpcy5nZXRNYXJnaW5YKCktdGhpcy5fbGFzdEVsZW1lbnQub2Zmc2V0TGVmdDtcblx0XHRcdHRoaXMuX3RleHQuc3R5bGUubGVmdCA9IHRoaXMuX3Bvc2l0aW9uK1wicHhcIjtcblx0XHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdH1cblx0fVxuXHRcblx0Z2V0UGFnZVNjb3BlKCkge1xuXHRcdGxldCBpbmRleCwgc3RhcnRJbmRleCwgZW5kSW5kZXg7XG5cdFx0Zm9yKGxldCBpPTA7IGk8IHRoaXMuX3NlY3Rpb25zLmxlbmd0aC0xOyBpKyspIHtcblx0XHRcdGlmKHRoaXMuX3NlY3Rpb25zW2ldLmNsYXNzTmFtZS5tYXRjaCgvd2Itbm8tcGFnZS8pKSB7XG5cdFx0XHRcdGlmKHN0YXJ0SW5kZXgpIHtcblx0XHRcdFx0XHRlbmRJbmRleCA9IGk7XG5cdFx0XHRcdFx0dGhpcy5fZW5kUGFnZSA9IHRoaXMuZWxlbWVudFBhZ2VOdW1iZXIodGhpcy5fc2VjdGlvbnNbZW5kSW5kZXhdLmlkKTtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyh0aGlzLl9lbmRQYWdlKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbmRleCA9IGk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmKGluZGV4ICYmICFzdGFydEluZGV4KSB7XG5cdFx0XHRcdFx0c3RhcnRJbmRleCA9IGk7XG5cdFx0XHRcdFx0dGhpcy5fc3RhcnRQYWdlID0gdGhpcy5lbGVtZW50UGFnZU51bWJlcih0aGlzLl9zZWN0aW9uc1tzdGFydEluZGV4XS5pZCk7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2codGhpcy5fc3RhcnRQYWdlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGdldFBhZ2VOdW1iZXIoKSB7XG5cdFx0bGV0IHBhZ2VOdW1iZXIgPSBNYXRoLmFicyhNYXRoLmZsb29yKHRoaXMuX3Bvc2l0aW9uL3RoaXMuX2NvbnRhaW5lcldpZHRoKSkrMTtcblx0XHRyZXR1cm4gcGFnZU51bWJlcjtcblx0fVxuXG5cdGdldFRvdGFsUGFnZXMoKSB7XG5cdFx0bGV0IHRvdGFsUGFnZXMgPSBNYXRoLmZsb29yKHRoaXMuX2xhc3RFbGVtZW50Lm9mZnNldExlZnQvdGhpcy5fY29udGFpbmVyV2lkdGgpO1xuXHRcdHJldHVybiB0b3RhbFBhZ2VzO1xuXHR9XG5cblx0Z29Ub1BhZ2UobnVtYmVyKSB7XG5cdFx0bnVtYmVyID0gKG51bWJlcjwxID8gMSA6IG51bWJlcik7XG5cdFx0bnVtYmVyPSAobnVtYmVyPnRoaXMuZ2V0VG90YWxQYWdlcygpID8gdGhpcy5nZXRUb3RhbFBhZ2VzKCkgOiBudW1iZXIpO1xuXHRcdGxldCBwb3NpdGlvbiA9IHRoaXMuX2NvbnRhaW5lcldpZHRoKihudW1iZXItMSk7XG5cdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gLXBvc2l0aW9uICsgXCJweFwiO1xuXHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fdGV4dC5vZmZzZXRMZWZ0O1xuXHRcdHRoaXMucmVmcmVzaCgpO1xuXHR9XG5cblx0ZWxlbWVudFBhZ2VOdW1iZXIoaWQpIHtcblx0XHRsZXQgZWwgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3IoJyMnICsgaWQpO1xuXHRcdGxldCBlbFBvc2l0aW9uID0gZWwub2Zmc2V0TGVmdCAtIHRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdGVsUG9zaXRpb24gPSAoZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCE9PTAgPyBlbFBvc2l0aW9uLWVsUG9zaXRpb24ldGhpcy5fY29udGFpbmVyV2lkdGggOiBlbFBvc2l0aW9uKTsvL2Fsd2F5cyBhdCBhIHBhZ2UgYmVnaW5uaW5nXG5cdFx0bGV0IGVsUGFnZU51bWJlciA9IGVsUG9zaXRpb24vdGhpcy5fY29udGFpbmVyV2lkdGggKyAxO1xuXHRcdHJldHVybiBlbFBhZ2VOdW1iZXI7XG5cdH1cblxuXHRnZXRTZWN0aW9uVGl0bGUoKSB7XG5cdFx0bGV0IHBvc2l0aW9uID0gLXRoaXMuX3Bvc2l0aW9uO1xuXHRcdGxldCB0aXRsZTtcblx0XHRmb3IobGV0IGk9MTsgaTx0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYodGhpcy5fc2VjdGlvbnNbaV0ub2Zmc2V0TGVmdC10aGlzLl9jb250YWluZXJXaWR0aD49cG9zaXRpb24pIHtcblx0XHRcdFx0bGV0IGlkID0gdGhpcy5fc2VjdGlvbnNbaS0xXS5pZDtcblx0XHRcdFx0aWYoaWQhPT11bmRlZmluZWQgJiYgdGhpcy5nZXRQYWdlTnVtYmVyKCkgPT09IHRoaXMuZWxlbWVudFBhZ2VOdW1iZXIoaWQpKSB7XG5cdFx0XHRcdFx0dGl0bGUgPSBcIlwiO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRpdGxlID0gdGhpcy5fc2VjdGlvbnNbaS0xXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItdGl0bGUnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRpdGxlO1xuXHR9XG5cdFxuXHRnZXRUb2MoKSB7XG5cdFx0aWYoIXRoaXMuX3RvYykgeyByZXR1cm47IH1cblx0XHRpZih0aGlzLl90b2MuZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRvYycpKSB7XG5cdFx0XHRsZXQgdG9jVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdFx0XHR0b2NUaXRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnd2ItdG9jLXRpdGxlJyk7XG5cdFx0XHR0b2NUaXRsZS5pbm5lckhUTUwgPSB0aGlzLl90b2MuZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRvYycpO1xuXHRcdFx0dGhpcy5fdG9jLmFwcGVuZENoaWxkKHRvY1RpdGxlKTtcblx0XHR9XG5cdFx0dGhpcy5fc2VjdGlvbnMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdGlmKCF2YWwuY2xhc3NOYW1lLm1hdGNoKC93Yi1uby10b2MvKSkge1xuXHRcdFx0XHRsZXQgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0XHRcdFx0cC5pbm5lckhUTUwgPSB2YWwuZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRpdGxlJyk7XG5cdFx0XHRcdHAuc2V0QXR0cmlidXRlKCdjbGFzcycsJ3diLXRvYy1pdGVtJyk7XG5cdFx0XHRcdGxldCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXHRcdFx0XHRhLnNldEF0dHJpYnV0ZSgnaHJlZicsICcjJyArIHZhbC5pZCk7XG5cdFx0XHRcdGEuc2V0QXR0cmlidXRlKCdjbGFzcycsICd3Yi1saW5rJyk7XG5cdFx0XHRcdGEuc2V0QXR0cmlidXRlKCdkYXRhLXdiLWVsZW1lbnQtcGFnZS1udW1iZXInLCB2YWwuaWQpO1xuXHRcdFx0XHRwLmFwcGVuZENoaWxkKGEpO1xuXHRcdFx0XHR0aGlzLl90b2MuYXBwZW5kQ2hpbGQocCk7XG5cdFx0XHR9XG5cdFx0fSlcblx0fVxuXHRcblx0Z2V0VG9jQ3VycmVudFNlY3Rpb24oKSB7XG5cdFx0bGV0IHBvc2l0aW9uID0gLXRoaXMuX3Bvc2l0aW9uO1xuXHRcdGZvcihsZXQgaT0xOyBpPHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZih0aGlzLl9zZWN0aW9uc1tpXS5vZmZzZXRMZWZ0LXRoaXMuX2NvbnRhaW5lcldpZHRoPj1wb3NpdGlvbikge1xuXHRcdFx0XHRsZXQgaWQgPSB0aGlzLl9zZWN0aW9uc1tpLTFdLmlkO1xuXHRcdFx0XHR0aGlzLl90b2MucXVlcnlTZWxlY3RvckFsbCgnYScpLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdFx0aWYodmFsLmdldEF0dHJpYnV0ZSgnaHJlZicpLnJlcGxhY2UoL14jLywnJykgPT09IGlkKSB7XG5cdFx0XHRcdFx0XHRpZighdmFsLnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lLm1hdGNoKC9jdXJyZW50LykpIHtcblx0XHRcdFx0XHRcdFx0dmFsLnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lKz0nIGN1cnJlbnQnO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZih2YWwucGFyZW50RWxlbWVudC5jbGFzc05hbWUubWF0Y2goL2N1cnJlbnQvKSkge1xuXHRcdFx0XHRcdFx0XHR2YWwucGFyZW50RWxlbWVudC5jbGFzc05hbWU9dmFsLnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lLnJlcGxhY2UoLyBjdXJyZW50LywnJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aW5zZXJ0Qm9va21hcmsoKSB7XG5cdFx0bGV0IGJvb2ttYXJrID0gbnVsbDtcblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9lbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGVsUG9zaXRpb24gPSB0aGlzLl9lbGVtZW50c1tpXS5vZmZzZXRMZWZ0LXRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdFx0ZWxQb3NpdGlvbiA9IChlbFBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIT09MCA/IGVsUG9zaXRpb24tZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCA6IGVsUG9zaXRpb24pOy8vYWx3YXlzIGF0IGEgcGFnZSBiZWdpbm5pbmdcblx0XHRcdGlmKGVsUG9zaXRpb24gPT09IC10aGlzLl9wb3NpdGlvbilcblx0XHRcdHtcblx0XHRcdFx0Ym9va21hcmsgPSBpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYoZWxQb3NpdGlvbiA+IC10aGlzLl9wb3NpdGlvbilcblx0XHRcdHtcblx0XHRcdFx0Ym9va21hcmsgPSBpLTE7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLl9ib29rbWFyayA9IGJvb2ttYXJrO1xuXHR9XG5cblx0Z29Ub0Jvb2ttYXJrKGJvb2ttYXJrKSB7XG5cdFx0bGV0IGVsZW1lbnQgPSB0aGlzLl9lbGVtZW50c1t0aGlzLl9ib29rbWFya107XG5cdFx0Ly9wb3NpdGlvbiA6IG9mZnNldExlZnQgb2YgZWxlbWVudCByZWxhdGl2ZSB0byB0ZXh0XG5cdFx0bGV0IHBvc2l0aW9uID0gZWxlbWVudC5vZmZzZXRMZWZ0LXRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdHBvc2l0aW9uID0gKHBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIT09MCA/IHBvc2l0aW9uLXBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIDogcG9zaXRpb24pOy8vYWx3YXlzIGF0IGEgcGFnZSBiZWdpbm5pbmdcblx0XHQvL3RleHQgcG9zaXRpb24gPSAtcG9zaXRpb25cblx0XHR0aGlzLl90ZXh0LnN0eWxlLmxlZnQgPSAtcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0dGhpcy5fcG9zaXRpb24gPSB0aGlzLl90ZXh0Lm9mZnNldExlZnQ7XG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cdH1cblxuXHRyZWZyZXNoKCkge1xuXHRcdHRoaXMuaW5zZXJ0Qm9va21hcmsoKTtcblxuXHRcdGlmKHRoaXMuY29sPT09ZmFsc2UpIHtcblx0XHRcdFxuXHRcdFx0dGhpcy5fY3VycmVudFBhZ2VzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdHZhbC5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuX3RvdGFsUGFnZXMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdFx0dmFsLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5fY3VycmVudFRvdGFsUGFnZXMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdFx0dmFsLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5fZWxQYWdlTnVtYmVycy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLl9zZWN0aW9uVGl0bGVzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdHZhbC5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHR9IGVsc2Uge1xuXHRcdFx0XG5cdFx0XHR0aGlzLmdldFBhZ2VTY29wZSgpO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLl90b2MpIHtcblx0XHRcdFx0dGhpcy5nZXRUb2NDdXJyZW50U2VjdGlvbigpO1xuXHRcdFx0fVx0XG5cdFx0XHRcblx0XHRcdHRoaXMuX2N1cnJlbnRQYWdlcy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHRpZih2YWwuaW5uZXJIVE1MIT10aGlzLmdldFBhZ2VOdW1iZXIoKSkge1xuXHRcdFx0XHRcdHZhbC5pbm5lckhUTUwgPSB0aGlzLmdldFBhZ2VOdW1iZXIoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuX3RvdGFsUGFnZXMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdFx0aWYodmFsLmlubmVySFRNTCE9dGhpcy5nZXRUb3RhbFBhZ2VzKCkpIHtcblx0XHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gdGhpcy5nZXRUb3RhbFBhZ2VzKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLl9jdXJyZW50VG90YWxQYWdlcy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHRpZih2YWwuaW5uZXJIVE1MIT09IHRoaXMuZ2V0UGFnZU51bWJlcigpICsgXCIvXCIgKyB0aGlzLmdldFRvdGFsUGFnZXMoKSkge1xuXHRcdFx0XHRcdHZhbC5pbm5lckhUTUwgPSB0aGlzLmdldFBhZ2VOdW1iZXIoKSArIFwiL1wiICsgdGhpcy5nZXRUb3RhbFBhZ2VzKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLl9lbFBhZ2VOdW1iZXJzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdGxldCBpZCA9IHZhbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItZWxlbWVudC1wYWdlLW51bWJlcicpO1xuXHRcdFx0XHRsZXQgcGFnZU51bWJlciA9IHRoaXMuZWxlbWVudFBhZ2VOdW1iZXIoaWQpO1xuXHRcdFx0XHRpZih2YWwuaW5uZXJIVE1MIT1wYWdlTnVtYmVyKSB7XG5cdFx0XHRcdFx0dmFsLmlubmVySFRNTCA9IHBhZ2VOdW1iZXI7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLl9zZWN0aW9uVGl0bGVzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdGlmKHZhbC5pbm5lckhUTUwhPT10aGlzLmdldFNlY3Rpb25UaXRsZSgpKSB7XG5cdFx0XHRcdFx0dmFsLmlubmVySFRNTCA9IHRoaXMuZ2V0U2VjdGlvblRpdGxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0fVxuXHR9XG59XG5cbiJdfQ==
