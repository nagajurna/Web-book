"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),WebBook=function(){function t(e,i){var n=this;_classCallCheck(this,t),this._bookContainer=e,this._textContainer=e.querySelector("[data-wb-text-container]"),this._text=e.querySelector("[data-wb-text]"),this._height=i.height,this._width=i.maxWidth,this._marginX=void 0===i.marginX?35:i.marginX,this._marginY=void 0===i.marginY?20:i.marginY,this._position=0,this.col=!0,this._bookmark=null,this._containerWidth=null,this._lastBreak=document.createElement("div"),this._lastBreak.className="wb-text-break",this._text.appendChild(this._lastBreak),this._lastElement=document.createElement("div"),this._lastElement.innerHTML="&nbsp;",this._lastElement.className="wb-section wb-no-toc",this._text.appendChild(this._lastElement),this._sections=this._text.querySelectorAll(".wb-section"),this._breaks=this._text.querySelectorAll(".wb-text-break"),this._elements=this._text.querySelectorAll(":not(.wb-text-break)"),this._tocs=this._bookContainer.querySelectorAll("[data-wb-toc]"),this.getToc(),this._currentPages=this._bookContainer.querySelectorAll(".wb-current-page"),this._totalPages=this._bookContainer.querySelectorAll(".wb-total-pages"),this._currentTotalPages=this._bookContainer.querySelectorAll(".wb-currentByTotal-pages"),this._elPageNumbers=this._bookContainer.querySelectorAll("[data-wb-element-page-number]"),this._sectionTitles=this._bookContainer.querySelectorAll(".wb-current-section-title"),this._startPage=null,this._bookContainer.querySelectorAll(".wb-link").forEach(function(t){t.addEventListener("click",function(t){if(!0===n.col){t.preventDefault();var e=t.currentTarget.getAttribute("href").replace(/^#/,"");n.goToPage(n.elementPageNumber(e))}},!1)}),("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style)&&this.toBook()}return _createClass(t,[{key:"toBook",value:function(){if("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style){this.col=!0;var t=this._textContainer.style,e=this._text.style;t.boxSizing="border-box",t.overflow="hidden",t.position="relative",t.padding="0px",t.height=this.getHeight()+"px",t.maxWidth=this.getMaxWidth()+"px",this._containerWidth=this._textContainer.clientWidth;for(var i=0;i<this._sections.length;i++)"10%"!==this._sections[i].style.minHeight&&(this._sections[i].style.minHeight="10%");for(var n=0;n<this._breaks.length;n++)"300%"!==this._breaks[n].style.marginBottom&&(this._breaks[n].style.marginBottom="300%");"300%"!==this._lastElement.style.marginBottom&&(this._lastElement.style.marginBottom="300%"),e.boxSizing="border-box",e.position="absolute",e.left=0,e.top=0,e.height="100%",e.width="100%",e.paddingRight=this.getMarginX()+"px",e.paddingLeft=this.getMarginX()+"px",e.paddingTop=this.getMarginY()+"px",e.paddingBottom=this.getMarginY()+"px",e.MozColumnFill="auto",e.WebkitColumnsWidth=this._containerWidth+"px",e.MozColumnWidth=this._containerWidth+"px",e.columnWidth=this._containerWidth+"px",e.MozColumnGap=2*this.getMarginX()+"px",e.WebkitColumnGap=2*this.getMarginX()+"px",e.columnGap=2*this.getMarginX()+"px",this._bookmark&&(this.goToBookmark(this._bookmark),this._position=this._text.offsetLeft),this.refresh()}}},{key:"toScroll",value:function(){this.col=!1;var t=this._container.style,e=this._text.style;t.height="auto",t.maxWidth=this.getMaxWidth()+"px",t.overflow="visible",e.position="static",e.height="auto",t.paddingRight=this.getMarginX()+"px",t.paddingLeft=this.getMarginX()+"px",t.paddingTop=this.getMarginY()+"px",t.paddingBottom=this.getMarginY()+"px",("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style)&&(e.WebkitColumns="auto 1",e.MozColumns="auto 1",e.columns="auto 1");for(var i=0;i<this._sections.length;i++)this._sections[i].style.minHeight="0";for(var n=0;n<this._breaks.length;n++)this._breaks[n].style.marginBottom="0";this._lastElement.style.marginBottom="0px",this.refresh()}},{key:"setMaxWidth",value:function(t){return this._width=t,this}},{key:"getMaxWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){return this._height=t,this}},{key:"getHeight",value:function(){return this._height}},{key:"setMarginX",value:function(t){return this._marginX=t,this}},{key:"getMarginX",value:function(){return this._marginX}},{key:"setMarginY",value:function(t){return this._marginY=t,this}},{key:"getMarginY",value:function(){return this._marginY}},{key:"forward",value:function(){this._lastElement.offsetLeft+this._position>this._containerWidth+this.getMarginX()&&(this._position=this._text.offsetLeft,this._position-=this._containerWidth,this._text.style.left=this._position+"px",this.refresh())}},{key:"backward",value:function(){this._position<0&&(this._position=this._text.offsetLeft,this._position+=this._containerWidth,this._text.style.left=this._position+"px",this.refresh())}},{key:"tofirstPage",value:function(){this._position<0&&(this._position=0,this._text.style.left=this._position+"px",this.refresh())}},{key:"tolastPage",value:function(){this._lastElement.offsetLeft+this._position>this._containerWidth+this.getMarginX()&&(this._position=this._containerWidth+this.getMarginX()-this._lastElement.offsetLeft,this._text.style.left=this._position+"px",this.refresh())}},{key:"getPageStart",value:function(){for(var t=void 0,e=void 0,i=0;i<this._sections.length-1;i++)if(this._sections[i].className.match(/wb-no-page/))t=i;else if(void 0!==t&&void 0===e){e=i;var n=this._sections[e].offsetLeft-this.getMarginX();n=n%this._containerWidth!=0?n-n%this._containerWidth:n,this._startPage=n/this._containerWidth}}},{key:"getPageNumber",value:function(){var t=Math.abs(Math.floor(this._position/this._containerWidth))+1;return t-=this._startPage}},{key:"getTotalPages",value:function(){var t=Math.floor(this._lastElement.offsetLeft/this._containerWidth);return t-=this._startPage}},{key:"goToPage",value:function(t){t=(t=t<1-this._startPage?1-this._startPage:t)>this.getTotalPages()?this.getTotalPages():t,t+=this._startPage;var e=this._containerWidth*(t-1);this._text.style.left=-e+"px",this._position=this._text.offsetLeft,this.refresh()}},{key:"elementPageNumber",value:function(t){var e=this._text.querySelector("#"+t).offsetLeft-this.getMarginX(),i=(e=e%this._containerWidth!=0?e-e%this._containerWidth:e)/this._containerWidth+1;return i-=this._startPage}},{key:"getSectionTitle",value:function(){for(var t=-this._position,e=void 0,i=1;i<this._sections.length;i++)if(this._sections[i].offsetLeft-this._containerWidth>=t){var n=this._sections[i-1].id;e=void 0!==n&&this.getPageNumber()===this.elementPageNumber(n)?"":this._sections[i-1].title;break}return e}},{key:"getToc",value:function(){var t=this;0!==this._tocs.length&&this._tocs.forEach(function(e){if(e.getAttribute("data-wb-toc")){var i=document.createElement("p");i.setAttribute("class","wb-toc-title"),i.innerHTML=e.getAttribute("data-wb-toc"),e.appendChild(i)}var n=document.createElement("ul");n.setAttribute("class","wb-toc-list"),t._sections.forEach(function(t){if(!t.className.match(/wb-no-toc/)){var e=document.createElement("li");e.setAttribute("class","wb-toc-item");var i=document.createElement("a");i.setAttribute("href","#"+t.id),i.setAttribute("class","wb-link");var s=document.createElement("span");s.setAttribute("class","wb-toc-item-title"),s.innerHTML=t.title;var o=document.createElement("span");s.setAttribute("class","wb-toc-item-page-number"),o.setAttribute("data-wb-element-page-number",t.id),i.appendChild(s),i.appendChild(o),e.appendChild(i),n.appendChild(e)}}),e.appendChild(n)})}},{key:"getTocCurrentSection",value:function(){var t=this,e=-this._position;this._tocs.forEach(function(i){for(var n=1;n<t._sections.length&&!(t._sections[n].offsetLeft-t._containerWidth>=e&&"break"===function(){var e=t._sections[n-1].id;return i.querySelectorAll("a").forEach(function(t){t.getAttribute("href").replace(/^#/,"")===e?t.parentElement.className.match(/current/)||(t.parentElement.className+=" current"):t.parentElement.className.match(/current/)&&(t.parentElement.className=t.parentElement.className.replace(/ current/,""))}),"break"}());n++);})}},{key:"insertBookmark",value:function(){for(var t=null,e=0;e<this._elements.length;e++){var i=this._elements[e].offsetLeft-this.getMarginX();if((i=i%this._containerWidth!=0?i-i%this._containerWidth:i)===-this._position){t=e;break}if(i>-this._position){t=e-1;break}}this._bookmark=t}},{key:"goToBookmark",value:function(t){var e=this._elements[this._bookmark].offsetLeft-this.getMarginX();e=e%this._containerWidth!=0?e-e%this._containerWidth:e,this._text.style.left=-e+"px",this._position=this._text.offsetLeft,this.refresh()}},{key:"refresh",value:function(){var t=this;this.insertBookmark(),!1===this.col?(this._currentPages.forEach(function(t){t.innerHTML=""}),this._totalPages.forEach(function(t){t.innerHTML=""}),this._currentTotalPages.forEach(function(t){t.innerHTML=""}),this._elPageNumbers.forEach(function(t){t.innerHTML=""}),this._sectionTitles.forEach(function(t){t.innerHTML=""})):(this.getPageStart(),0!==this._tocs.length&&this.getTocCurrentSection(),this._currentPages.forEach(function(e){e.innerHTML!=t.getPageNumber()&&(e.innerHTML=t.getPageNumber())}),this._totalPages.forEach(function(e){e.innerHTML!=t.getTotalPages()&&(e.innerHTML=t.getTotalPages())}),this._currentTotalPages.forEach(function(e){t.getPageNumber()<1?e.innerHTML="&emsp;&emsp;":e.innerHTML!==t.getPageNumber()+"/"+t.getTotalPages()&&(e.innerHTML=t.getPageNumber()+"/"+t.getTotalPages())}),this._elPageNumbers.forEach(function(e){var i=e.getAttribute("data-wb-element-page-number"),n=t.elementPageNumber(i);n<1?e.innerHTML="":e.innerHTML!=n&&(e.innerHTML=n)}),this._sectionTitles.forEach(function(e){e.innerHTML!==t.getSectionTitle()&&(e.innerHTML=t.getSectionTitle())}))}}]),t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYi1ib29rLmpzIl0sIm5hbWVzIjpbIldlYkJvb2siLCJib29rQ29udGFpbmVyIiwib3B0aW9ucyIsIl90aGlzIiwidGhpcyIsIl9jbGFzc0NhbGxDaGVjayIsIl9ib29rQ29udGFpbmVyIiwiX3RleHRDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiX3RleHQiLCJfaGVpZ2h0IiwiX3dpZHRoIiwibWF4V2lkdGgiLCJfbWFyZ2luWCIsInVuZGVmaW5lZCIsIm1hcmdpblgiLCJfbWFyZ2luWSIsIm1hcmdpblkiLCJfcG9zaXRpb24iLCJoZWlnaHQiLCJfbGFzdEVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjb2wiLCJjbGFzc05hbWUiLCJfYm9va21hcmsiLCJfc2VjdGlvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2xhc3RCcmVhayIsIl9lbGVtZW50cyIsIl90b3RhbFBhZ2VzIiwiX2JyZWFrcyIsIl9lbFBhZ2VOdW1iZXJzIiwiX3RvY3MiLCJmb3JFYWNoIiwidmFsIiwiX2N1cnJlbnRQYWdlcyIsImUiLCJfY3VycmVudFRvdGFsUGFnZXMiLCJfc2VjdGlvblRpdGxlcyIsImdvVG9QYWdlIiwiZWxlbWVudFBhZ2VOdW1iZXIiLCJpZCIsImJvZHkiLCJzdHlsZSIsInByZXZlbnREZWZhdWx0IiwiY3MiLCJ0cyIsInRvQm9vayIsImJveFNpemluZyIsIm92ZXJmbG93IiwicG9zaXRpb24iLCJwYWRkaW5nIiwiZ2V0SGVpZ2h0IiwiZ2V0TWF4V2lkdGgiLCJfY29udGFpbmVyV2lkdGgiLCJjbGllbnRXaWR0aCIsImkiLCJsZW5ndGgiLCJtaW5IZWlnaHQiLCJtYXJnaW5Cb3R0b20iLCJsZWZ0IiwidG9wIiwid2lkdGgiLCJwYWRkaW5nUmlnaHQiLCJwYWRkaW5nTGVmdCIsImdldE1hcmdpblgiLCJwYWRkaW5nVG9wIiwiZ2V0TWFyZ2luWSIsInBhZGRpbmdCb3R0b20iLCJNb3pDb2x1bW5GaWxsIiwiV2Via2l0Q29sdW1uc1dpZHRoIiwib2Zmc2V0TGVmdCIsIldlYmtpdENvbHVtbkdhcCIsIl9jb250YWluZXIiLCJjb2x1bW5zIiwicmVmcmVzaCIsInciLCJoIiwibSIsImluZGV4IiwibWF0Y2giLCJzdGFydEluZGV4IiwiZWxQb3NpdGlvbiIsInBhZ2VOdW1iZXIiLCJNYXRoIiwiX3N0YXJ0UGFnZSIsInRvdGFsUGFnZXMiLCJmbG9vciIsIm51bWJlciIsImdldFRvdGFsUGFnZXMiLCJlbFBhZ2VOdW1iZXIiLCJ0aXRsZSIsImdldFBhZ2VOdW1iZXIiLCJnZXRBdHRyaWJ1dGUiLCJ0b2NUaXRsZSIsInNldEF0dHJpYnV0ZSIsImxpc3QiLCJfdGhpczIiLCJpdGVtIiwibGluayIsImFwcGVuZENoaWxkIiwicGFnZSIsIl90aGlzMyIsInRvYyIsInJlcGxhY2UiLCJwYXJlbnRFbGVtZW50IiwiYm9va21hcmsiLCJfdGhpczQiLCJpbnNlcnRCb29rbWFyayIsImdldFBhZ2VTdGFydCIsImdldFRvY0N1cnJlbnRTZWN0aW9uIiwiZWxlbWVudCIsImdldFNlY3Rpb25UaXRsZSJdLCJtYXBwaW5ncyI6IjZYQUFNQSxtQkFDTCxTQUFBQSxFQUFZQyxFQUFlQyxHQUFTLElBQUFDLEVBQUFDLEtBQUFDLGdCQUFBRCxLQUFBSixHQUVuQ0ksS0FBS0UsZUFBaUJMLEVBQ3RCRyxLQUFLRyxlQUFpQk4sRUFBY08sY0FBYyw0QkFDbERKLEtBQUtLLE1BQVFSLEVBQWNPLGNBQWMsa0JBSjFDSixLQUFBTSxRQUFBUixFQUFZRCxPQUF3QkcsS0FBQU8sT0FBQVQsRUFBQVUsU0FRbkNSLEtBQUtTLGNBQTZCQyxJQUFsQlosRUFBUWEsUUFBc0IsR0FBS2IsRUFBUWEsUUFSeEJYLEtBQUFZLGNBQUFGLElBQUFaLEVBQUFlLFFBQUEsR0FBQWYsRUFBQWUsUUFDbkNiLEtBQUFjLFVBQUEsRUFDQWQsS0FBS0UsS0FBQUEsRUFDTEYsS0FBS0csVUFBQUEsS0FDTEgsS0FBS0ssZ0JBQVFSLEtBRWJHLEtBQUtNLFdBQVVSLFNBQVFpQixjQUF2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RixFQUFBZixtQkFJQTFGLEtBQUEyQixZQUFBSSxRQUFBLFNBQUFDLEdBMENLQSxFQUFJYixXQUFXc0YsRUFBS2xCLGtCQUN0QnZELEVBQUliLFVBQVlzRixFQUFLbEIsbUJBeEN4QnZGLEtBQUswRyxtQkFBTDNFLFFBQUEsU0FBQUMsR0E2Q0t5RSxFQUFLZixnQkFBa0IsRUEzQzVCMUQsRUFBR2IsVUFBVyxlQTZDRmEsRUFBSWIsWUFBYXNGLEVBQUtmLGdCQUFrQixJQUFNZSxFQUFLbEIsa0JBM0M5RHZELEVBQUtDLFVBQUFBLEVBQWNGLGdCQUFTLElBQU8wRSxFQUFBbEIsbUJBSW5DdkYsS0FBQTZCLGVBQWlCRSxRQUFTLFNBQUFDLEdBQ3pCQSxJQUFBQSxFQUFJYixFQUFBQSxhQUFKLCtCQUREOEQsRUFBQXdCLEVBQUFuRSxrQkFBQUMsR0ErQ0kwQyxFQUFhLEVBM0NqQmpELEVBQUtHLFVBQUFBLEdBQ0FoQixFQUFKQSxXQUFBOEQsSUFERGpELEVBQUFiLFVBQUE4RCxLQU1DakYsS0FGRG9DLGVBQUFMLFFBQUEsU0FBQUMsR0ErQ0lBLEVBQUliLFlBQVlzRixFQUFLSyxvQkEzQ3pCOUUsRUFBS0ksVUFBQUEsRUFBZUwiLCJmaWxlIjoid2ViLWJvb2subWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgV2ViQm9vayB7XG5cdGNvbnN0cnVjdG9yKGJvb2tDb250YWluZXIsIG9wdGlvbnMpIHtcblx0XHQvL2NvbnRhaW5lcnNcblx0XHR0aGlzLl9ib29rQ29udGFpbmVyID0gYm9va0NvbnRhaW5lcjtcblx0XHR0aGlzLl90ZXh0Q29udGFpbmVyID0gYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS13Yi10ZXh0LWNvbnRhaW5lcl0nKTtcblx0XHR0aGlzLl90ZXh0ID0gYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS13Yi10ZXh0XScpO1xuXHRcdC8vb3B0aW9uc1xuXHRcdHRoaXMuX2hlaWdodCA9IG9wdGlvbnMuaGVpZ2h0O1xuXHRcdHRoaXMuX3dpZHRoID0gb3B0aW9ucy5tYXhXaWR0aDtcblx0XHR0aGlzLl9tYXJnaW5YID0gb3B0aW9ucy5tYXJnaW5YPT09dW5kZWZpbmVkID8gMzUgOiBvcHRpb25zLm1hcmdpblg7XG5cdFx0dGhpcy5fbWFyZ2luWSA9IG9wdGlvbnMubWFyZ2luWT09PXVuZGVmaW5lZCA/IDIwIDogb3B0aW9ucy5tYXJnaW5ZO1xuXHRcdC8vaW5pdCBwb3NpdGlvbiwgY29sICxjb250YWluZXJXaWR0aCBhbmQgYm9va21hcmtcblx0XHR0aGlzLl9wb3NpdGlvbiA9IDA7XG5cdFx0dGhpcy5jb2wgPSB0cnVlOy8vZGVmYXVsdCB0cnVlID0gdG9Cb29rKClcblx0XHR0aGlzLl9ib29rbWFyayA9IG51bGw7XG5cdFx0dGhpcy5fY29udGFpbmVyV2lkdGggPSBudWxsO1xuXHRcdC8vdGhpcy5sYXN0QnJlYWsgaXMgdXNlZCBhcyBhIGdob3N0IHBhZ2Vcblx0XHR0aGlzLl9sYXN0QnJlYWsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuX2xhc3RCcmVhay5jbGFzc05hbWUgPSBcIndiLXRleHQtYnJlYWtcIjtcblx0XHR0aGlzLl90ZXh0LmFwcGVuZENoaWxkKHRoaXMuX2xhc3RCcmVhayk7XG5cdFx0Ly90aGlzLl9sYXN0RWxlbWVudCBpcyB1c2VkIGFzIGxhbmRtYXJrXG5cdFx0dGhpcy5fbGFzdEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuX2xhc3RFbGVtZW50LmlubmVySFRNTCA9IFwiJm5ic3A7XCI7Ly9ub3QgZW1wdHkgKGZvciBtb3pDb2x1bW5zKVxuXHRcdHRoaXMuX2xhc3RFbGVtZW50LmNsYXNzTmFtZSA9IFwid2Itc2VjdGlvbiB3Yi1uby10b2NcIjtcblx0XHR0aGlzLl90ZXh0LmFwcGVuZENoaWxkKHRoaXMuX2xhc3RFbGVtZW50KTtcblx0XHQvL3NlY3Rpb25zXG5cdFx0dGhpcy5fc2VjdGlvbnMgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1zZWN0aW9uJyk7XG5cdFx0Ly9icmVha3Ncblx0XHR0aGlzLl9icmVha3MgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi10ZXh0LWJyZWFrJyk7XG5cdFx0Ly9lbGVtZW50cyA6IHNlbGVjdCBhbGwgZWxlbWVudHMgYnV0IC50ZXh0LWJyZWFrcyAoZm9yIGJvb2ttYXJrcylcblx0XHR0aGlzLl9lbGVtZW50cyA9IHRoaXMuX3RleHQucXVlcnlTZWxlY3RvckFsbCgnOm5vdCgud2ItdGV4dC1icmVhayknKTtcblx0XHQvL3RvY1xuXHRcdHRoaXMuX3RvY3MgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXdiLXRvY10nKTtcblx0XHQvL3NldFRvYyBiZWZvcmUgcXVlcnlpbmcgdGhpcy5lbFBhZ2VOdW1iZXJzXG5cdFx0dGhpcy5nZXRUb2MoKTtcblx0XHQvL2luZm9zIGNvbnRhaW5lcnNcblx0XHR0aGlzLl9jdXJyZW50UGFnZXMgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1jdXJyZW50LXBhZ2UnKTtcblx0XHR0aGlzLl90b3RhbFBhZ2VzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcud2ItdG90YWwtcGFnZXMnKTtcblx0XHR0aGlzLl9jdXJyZW50VG90YWxQYWdlcyA9IHRoaXMuX2Jvb2tDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLndiLWN1cnJlbnRCeVRvdGFsLXBhZ2VzJyk7XG5cdFx0dGhpcy5fZWxQYWdlTnVtYmVycyA9IHRoaXMuX2Jvb2tDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtd2ItZWxlbWVudC1wYWdlLW51bWJlcl0nKTtcblx0XHR0aGlzLl9zZWN0aW9uVGl0bGVzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcud2ItY3VycmVudC1zZWN0aW9uLXRpdGxlJyk7XG5cdFx0Ly9zdGFydCBwYWdpbmF0aW9uXG5cdFx0dGhpcy5fc3RhcnRQYWdlID0gbnVsbDtcblx0XHQvL2xpbmtzIDogcmVwbGFjZSBkZWZhdWx0IHdpdGggZ29Ub1BhZ2Vcblx0XHRsZXQgbGlua3MgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1saW5rJyk7XG5cdFx0bGlua3MuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdHZhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdFx0XHRpZih0aGlzLmNvbD09PXRydWUpIHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0bGV0IGhyZWYgPSBlLmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG5cdFx0XHRcdFx0bGV0IGlkID0gaHJlZi5yZXBsYWNlKC9eIy8sXCJcIik7XG5cdFx0XHRcdFx0dGhpcy5nb1RvUGFnZSh0aGlzLmVsZW1lbnRQYWdlTnVtYmVyKGlkKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIGZhbHNlKTtcblx0XHR9KVxuXHRcdFxuXHRcdFxuXHRcdGlmKCdXZWJraXRDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnTW96Q29sdW1uV2lkdGgnIGluIGRvY3VtZW50LmJvZHkuc3R5bGUgfHwgJ2NvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlKSB7XG5cdFx0XHR0aGlzLnRvQm9vaygpO1xuXHRcdH1cblxuXHR9XG5cblx0dG9Cb29rKCkge1xuXHRcdGlmKCdXZWJraXRDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnTW96Q29sdW1uV2lkdGgnIGluIGRvY3VtZW50LmJvZHkuc3R5bGUgfHwgJ2NvbHVtbldpZHRoJyAgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSkge1xuXHRcdFx0dGhpcy5jb2wgPSB0cnVlO1xuXHRcdFx0bGV0IGNzID0gdGhpcy5fdGV4dENvbnRhaW5lci5zdHlsZTtcblx0XHRcdGxldCB0cyA9IHRoaXMuX3RleHQuc3R5bGU7XG5cdFx0XHQvL3RleHQtY29udGFpbmVyXG5cdFx0XHRjcy5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblx0XHRcdGNzLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblx0XHRcdGNzLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuXHRcdFx0Y3MucGFkZGluZyA9IFwiMHB4XCI7XG5cdFx0XHRjcy5oZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpICsgXCJweFwiO1xuXHRcdFx0Y3MubWF4V2lkdGggPSB0aGlzLmdldE1heFdpZHRoKCkgKyBcInB4XCI7Ly9tYXhXaWR0aCA6IHJlc3BvbnNpdmVcblx0XHRcdHRoaXMuX2NvbnRhaW5lcldpZHRoID0gdGhpcy5fdGV4dENvbnRhaW5lci5jbGllbnRXaWR0aDsvL3Jlc3BvbnNpdmVcblx0XHRcdFxuXHRcdFx0Ly9zZWN0aW9uc1xuXHRcdFx0Ly9oYWNrIGZpcmVmb3ggKHBvdXIgb2Zmc2V0TGVmdCkgOiBtaW5IZWlnaHQgPSAxMCVcblx0XHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmKHRoaXMuX3NlY3Rpb25zW2ldLnN0eWxlLm1pbkhlaWdodCE9PVwiMTAlXCIpIHtcblx0XHRcdFx0XHR0aGlzLl9zZWN0aW9uc1tpXS5zdHlsZS5taW5IZWlnaHQgPSBcIjEwJVwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvL21hbnVhbCBicmVha3Ncblx0XHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX2JyZWFrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZih0aGlzLl9icmVha3NbaV0uc3R5bGUubWFyZ2luQm90dG9tIT09XCIzMDAlXCIpIHtcblx0XHRcdFx0XHR0aGlzLl9icmVha3NbaV0uc3R5bGUubWFyZ2luQm90dG9tID0gXCIzMDAlXCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdC8vbGFzdCBlbGVtZW50XG5cdFx0XHRpZih0aGlzLl9sYXN0RWxlbWVudC5zdHlsZS5tYXJnaW5Cb3R0b20hPT1cIjMwMCVcIikge1xuXHRcdFx0XHR0aGlzLl9sYXN0RWxlbWVudC5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjMwMCVcIjtcblx0XHRcdH1cblxuXHRcdFx0Ly90ZXh0XG5cdFx0XHR0cy5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblx0XHRcdHRzLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXHRcdFx0dHMubGVmdCA9IDA7XG5cdFx0XHR0cy50b3AgPSAwO1xuXHRcdFx0dHMuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0XHR0cy53aWR0aCA9IFwiMTAwJVwiO1xuXHRcdFx0dHMucGFkZGluZ1JpZ2h0ID0gdGhpcy5nZXRNYXJnaW5YKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5wYWRkaW5nTGVmdCA9IHRoaXMuZ2V0TWFyZ2luWCgpICsgXCJweFwiO1xuXHRcdFx0dHMucGFkZGluZ1RvcCA9IHRoaXMuZ2V0TWFyZ2luWSgpICsgXCJweFwiO1xuXHRcdFx0dHMucGFkZGluZ0JvdHRvbSA9IHRoaXMuZ2V0TWFyZ2luWSgpICsgXCJweFwiO1xuXHRcdFx0dHMuTW96Q29sdW1uRmlsbCA9IFwiYXV0b1wiOy8vaW1wb3J0YW50ICEhIVxuXHRcdFx0dHMuV2Via2l0Q29sdW1uc1dpZHRoID0gdGhpcy5fY29udGFpbmVyV2lkdGggKyBcInB4XCI7XG5cdFx0XHR0cy5Nb3pDb2x1bW5XaWR0aCA9IHRoaXMuX2NvbnRhaW5lcldpZHRoICsgXCJweFwiO1xuXHRcdFx0dHMuY29sdW1uV2lkdGggPSB0aGlzLl9jb250YWluZXJXaWR0aCArIFwicHhcIjtcblx0XHRcdHRzLk1vekNvbHVtbkdhcCA9IHRoaXMuZ2V0TWFyZ2luWCgpKjIgKyBcInB4XCI7XG5cdFx0XHR0cy5XZWJraXRDb2x1bW5HYXAgPSB0aGlzLmdldE1hcmdpblgoKSoyICsgXCJweFwiO1xuXHRcdFx0dHMuY29sdW1uR2FwID0gdGhpcy5nZXRNYXJnaW5YKCkqMiArIFwicHhcIjtcblx0XHRcdFxuXHRcdFx0Ly9HbyB0byBib29rbWFya1xuXHRcdFx0aWYodGhpcy5fYm9va21hcmspIHtcblx0XHRcdFx0dGhpcy5nb1RvQm9va21hcmsodGhpcy5fYm9va21hcmspO1xuXHRcdFx0XHR0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3RleHQub2Zmc2V0TGVmdDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly9SZWZyZXNoIGluZm8gY29udGFpbmVyc1xuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0XHQvL2NvbnNvbGUubG9nKHRoaXMuX2Jvb2tDb250YWluZXIub2Zmc2V0SGVpZ2h0IC0gdGhpcy5nZXRIZWlnaHQoKSk7XG5cdFx0fVxuXHR9XG5cblx0dG9TY3JvbGwoKSB7XG5cdFx0J3VzZSBzdHJpY3QnO1xuXHRcdHRoaXMuY29sID0gZmFsc2U7XG5cdFx0bGV0IGNzID0gdGhpcy5fY29udGFpbmVyLnN0eWxlO1xuXHRcdGxldCB0cyA9IHRoaXMuX3RleHQuc3R5bGU7XG5cdFx0Ly9jb250YWluZXJcblx0XHRjcy5oZWlnaHQgPSBcImF1dG9cIjtcblx0XHRjcy5tYXhXaWR0aCA9IHRoaXMuZ2V0TWF4V2lkdGgoKSArIFwicHhcIjtcblx0XHRjcy5vdmVyZmxvdyA9IFwidmlzaWJsZVwiO1xuXHRcdC8vdGV4dFxuXHRcdHRzLnBvc2l0aW9uID0gXCJzdGF0aWNcIjtcblx0XHR0cy5oZWlnaHQgPSBcImF1dG9cIjtcblx0XHRjcy5wYWRkaW5nUmlnaHQgPSB0aGlzLmdldE1hcmdpblgoKSArIFwicHhcIjtcblx0XHRjcy5wYWRkaW5nTGVmdCA9IHRoaXMuZ2V0TWFyZ2luWCgpICsgXCJweFwiO1xuXHRcdGNzLnBhZGRpbmdUb3AgPSB0aGlzLmdldE1hcmdpblkoKSArIFwicHhcIjtcblx0XHRjcy5wYWRkaW5nQm90dG9tID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cblx0XHRpZignV2Via2l0Q29sdW1uV2lkdGgnIGluIGRvY3VtZW50LmJvZHkuc3R5bGUgfHwgJ01vekNvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdjb2x1bW5XaWR0aCcgIGluIGRvY3VtZW50LmJvZHkuc3R5bGUpIHtcblx0XHRcdHRzLldlYmtpdENvbHVtbnMgPSBcImF1dG8gMVwiO1xuXHRcdFx0dHMuTW96Q29sdW1ucyA9IFwiYXV0byAxXCI7XG5cdFx0XHR0cy5jb2x1bW5zID0gXCJhdXRvIDFcIjtcblx0XHR9XG5cblx0XHQvL1NlY3Rpb25zIChmb3IgbW96Q29sdW1ucylcblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGhpcy5fc2VjdGlvbnNbaV0uc3R5bGUubWluSGVpZ2h0ID0gXCIwXCI7XG5cdFx0fVxuXHRcdC8vbWFudWFsIGJyZWFrc1xuXHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX2JyZWFrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGhpcy5fYnJlYWtzW2ldLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMFwiO1xuXHRcdH1cblx0XHQvL2xhc3QgZWxlbWVudFxuXHRcdHRoaXMuX2xhc3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMHB4XCI7XG5cblx0XHR0aGlzLnJlZnJlc2goKTtcblx0fTtcblxuXHRzZXRNYXhXaWR0aCh3KSB7XG5cdFx0dGhpcy5fd2lkdGggPSB3O1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0Z2V0TWF4V2lkdGgoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3dpZHRoO1xuXHR9XG5cblx0c2V0SGVpZ2h0KGgpIHtcblx0XHR0aGlzLl9oZWlnaHQgPSBoO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0Z2V0SGVpZ2h0KCkge1xuXHRcdHJldHVybiB0aGlzLl9oZWlnaHQ7XG5cdH1cblxuXHRzZXRNYXJnaW5YKG0pIHtcblx0XHR0aGlzLl9tYXJnaW5YID0gbTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGdldE1hcmdpblgoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX21hcmdpblg7XG5cdH1cblxuXHRzZXRNYXJnaW5ZKG0pIHtcblx0XHR0aGlzLl9tYXJnaW5ZID0gbTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGdldE1hcmdpblkoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX21hcmdpblk7XG5cdH1cblxuXHRmb3J3YXJkKCkge1xuXHRcdGlmKHRoaXMuX2xhc3RFbGVtZW50Lm9mZnNldExlZnQrdGhpcy5fcG9zaXRpb24gPiB0aGlzLl9jb250YWluZXJXaWR0aCt0aGlzLmdldE1hcmdpblgoKSkge1xuXHRcdFx0Ly9sZXQgY2xvbmUgPSB0aGlzLl90ZXh0LmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fdGV4dC5vZmZzZXRMZWZ0O1xuXHRcdFx0dGhpcy5fcG9zaXRpb24gLT0gdGhpcy5fY29udGFpbmVyV2lkdGg7XG5cdFx0XHR0aGlzLl90ZXh0LnN0eWxlLmxlZnQgPSB0aGlzLl9wb3NpdGlvbiArIFwicHhcIjtcblx0XHRcdFxuXHRcdFx0Ly9jb25zb2xlLmxvZyhjbG9uZSk7XG5cdFx0XHQvL2Nsb25lLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXHRcdFx0Ly90aGlzLl9jb250YWluZXIuaW5zZXJ0QmVmb3JlKGNsb25lLHRoaXMudGV4dCk7XG5cdFx0XHR0aGlzLnJlZnJlc2goKTtcblx0XHR9XG5cdH1cblxuXHRiYWNrd2FyZCgpIHtcblx0XHRpZih0aGlzLl9wb3NpdGlvbiA8IDApIHtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fdGV4dC5vZmZzZXRMZWZ0O1xuXHRcdFx0dGhpcy5fcG9zaXRpb24gKz0gdGhpcy5fY29udGFpbmVyV2lkdGg7XG5cdFx0XHR0aGlzLl90ZXh0LnN0eWxlLmxlZnQgPSB0aGlzLl9wb3NpdGlvbiArIFwicHhcIjtcblx0XHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdH1cblx0fVxuXG5cdHRvZmlyc3RQYWdlKCkge1xuXHRcdGlmKHRoaXMuX3Bvc2l0aW9uIDwgMCkge1xuXHRcdFx0dGhpcy5fcG9zaXRpb24gPSAwO1xuXHRcdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gdGhpcy5fcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0XHR0aGlzLnJlZnJlc2goKTtcblx0XHR9XG5cdH1cblxuXHR0b2xhc3RQYWdlKCkge1xuXHRcdGlmKHRoaXMuX2xhc3RFbGVtZW50Lm9mZnNldExlZnQrdGhpcy5fcG9zaXRpb24gPiB0aGlzLl9jb250YWluZXJXaWR0aCt0aGlzLmdldE1hcmdpblgoKSkge1xuXHRcdFx0dGhpcy5fcG9zaXRpb24gPSB0aGlzLl9jb250YWluZXJXaWR0aCt0aGlzLmdldE1hcmdpblgoKS10aGlzLl9sYXN0RWxlbWVudC5vZmZzZXRMZWZ0O1xuXHRcdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gdGhpcy5fcG9zaXRpb24rXCJweFwiO1xuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRnZXRQYWdlU3RhcnQoKSB7XG5cdFx0bGV0IGluZGV4LCBzdGFydEluZGV4O1xuXHRcdGZvcihsZXQgaT0wOyBpPCB0aGlzLl9zZWN0aW9ucy5sZW5ndGgtMTsgaSsrKSB7XG5cdFx0XHRpZih0aGlzLl9zZWN0aW9uc1tpXS5jbGFzc05hbWUubWF0Y2goL3diLW5vLXBhZ2UvKSkge1xuXHRcdFx0XHRpbmRleCA9IGk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZihpbmRleCE9PXVuZGVmaW5lZCAmJiBzdGFydEluZGV4PT09dW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0c3RhcnRJbmRleCA9IGk7XG5cdFx0XHRcdFx0bGV0IGVsID0gdGhpcy5fc2VjdGlvbnNbc3RhcnRJbmRleF07XG5cdFx0XHRcdFx0bGV0IGVsUG9zaXRpb24gPSBlbC5vZmZzZXRMZWZ0IC0gdGhpcy5nZXRNYXJnaW5YKCk7XG5cdFx0XHRcdFx0ZWxQb3NpdGlvbiA9IChlbFBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIT09MCA/IGVsUG9zaXRpb24tZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCA6IGVsUG9zaXRpb24pOy8vYWx3YXlzIGF0IGEgcGFnZSBiZWdpbm5pbmdcblx0XHRcdFx0XHR0aGlzLl9zdGFydFBhZ2UgPSBlbFBvc2l0aW9uL3RoaXMuX2NvbnRhaW5lcldpZHRoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Z2V0UGFnZU51bWJlcigpIHtcblx0XHQvL3RoaXMuX3Bvc2l0aW9uL3RoaXMuX2NvbnRhaW5lcldpZHRoIGlzIHN0YXJ0IG9mIGEgcGFnZSA6IHN0YXJ0IDAgaXMgcGFnZSAxLC4uLiAoc28gOiArMSlcblx0XHRsZXQgcGFnZU51bWJlciA9IE1hdGguYWJzKE1hdGguZmxvb3IodGhpcy5fcG9zaXRpb24vdGhpcy5fY29udGFpbmVyV2lkdGgpKSsxO1xuXHRcdC8vdGhpcy5fc3RhcnRQYWdlIChwYWdpbmF0aW9uIHN0YXJ0KVxuXHRcdHBhZ2VOdW1iZXIgPSBwYWdlTnVtYmVyLSh0aGlzLl9zdGFydFBhZ2UpO1xuXHRcdHJldHVybiBwYWdlTnVtYmVyO1xuXHR9XG5cblx0Z2V0VG90YWxQYWdlcygpIHtcblx0XHRsZXQgdG90YWxQYWdlcyA9IE1hdGguZmxvb3IodGhpcy5fbGFzdEVsZW1lbnQub2Zmc2V0TGVmdC90aGlzLl9jb250YWluZXJXaWR0aCk7XG5cdFx0dG90YWxQYWdlcyA9IHRvdGFsUGFnZXMtKHRoaXMuX3N0YXJ0UGFnZSk7XG5cdFx0cmV0dXJuIHRvdGFsUGFnZXM7XG5cdH1cblxuXHRnb1RvUGFnZShudW1iZXIpIHtcblx0XHRudW1iZXIgPSAobnVtYmVyPDEtKHRoaXMuX3N0YXJ0UGFnZSkgPyAxLSh0aGlzLl9zdGFydFBhZ2UpIDogbnVtYmVyKTtcblx0XHRudW1iZXI9IChudW1iZXI+dGhpcy5nZXRUb3RhbFBhZ2VzKCkgPyB0aGlzLmdldFRvdGFsUGFnZXMoKSA6IG51bWJlcik7XG5cdFx0bnVtYmVyID0gbnVtYmVyICsgKHRoaXMuX3N0YXJ0UGFnZSk7XG5cdFx0bGV0IHBvc2l0aW9uID0gdGhpcy5fY29udGFpbmVyV2lkdGgqKG51bWJlci0xKTtcblx0XHR0aGlzLl90ZXh0LnN0eWxlLmxlZnQgPSAtcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0dGhpcy5fcG9zaXRpb24gPSB0aGlzLl90ZXh0Lm9mZnNldExlZnQ7XG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cdH1cblxuXHRlbGVtZW50UGFnZU51bWJlcihpZCkge1xuXHRcdGxldCBlbCA9IHRoaXMuX3RleHQucXVlcnlTZWxlY3RvcignIycgKyBpZCk7XG5cdFx0bGV0IGVsUG9zaXRpb24gPSBlbC5vZmZzZXRMZWZ0IC0gdGhpcy5nZXRNYXJnaW5YKCk7XG5cdFx0ZWxQb3NpdGlvbiA9IChlbFBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIT09MCA/IGVsUG9zaXRpb24tZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCA6IGVsUG9zaXRpb24pOy8vYWx3YXlzIGF0IGEgcGFnZSBiZWdpbm5pbmdcblx0XHRsZXQgZWxQYWdlTnVtYmVyID0gZWxQb3NpdGlvbi90aGlzLl9jb250YWluZXJXaWR0aCArIDE7Ly9lbFBvc2l0aW9uL3RoaXMuX2NvbnRhaW5lcldpZHRoIGlzIHBvc2l0aW9uIG9mIGEgcGFnZSA6IHBvc2l0aW9uIDAgaXMgcGFnZSAxLC4uLlxuXHRcdGVsUGFnZU51bWJlciA9IGVsUGFnZU51bWJlci0odGhpcy5fc3RhcnRQYWdlKTtcblx0XHRyZXR1cm4gZWxQYWdlTnVtYmVyO1xuXHR9XG5cblx0Z2V0U2VjdGlvblRpdGxlKCkge1xuXHRcdGxldCBwb3NpdGlvbiA9IC10aGlzLl9wb3NpdGlvbjtcblx0XHRsZXQgdGl0bGU7XG5cdFx0Zm9yKGxldCBpPTE7IGk8dGhpcy5fc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmKHRoaXMuX3NlY3Rpb25zW2ldLm9mZnNldExlZnQtdGhpcy5fY29udGFpbmVyV2lkdGg+PXBvc2l0aW9uKSB7XG5cdFx0XHRcdGxldCBpZCA9IHRoaXMuX3NlY3Rpb25zW2ktMV0uaWQ7XG5cdFx0XHRcdGlmKGlkIT09dW5kZWZpbmVkICYmIHRoaXMuZ2V0UGFnZU51bWJlcigpID09PSB0aGlzLmVsZW1lbnRQYWdlTnVtYmVyKGlkKSkge1xuXHRcdFx0XHRcdHRpdGxlID0gXCJcIjtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aXRsZSA9IHRoaXMuX3NlY3Rpb25zW2ktMV0udGl0bGU7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aXRsZTtcblx0fVxuXHRcblx0Z2V0VG9jKCkge1xuXHRcdGlmKHRoaXMuX3RvY3MubGVuZ3RoPT09MCkgeyByZXR1cm47IH1cblx0XHR0aGlzLl90b2NzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRpZih2YWwuZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRvYycpKSB7XG5cdFx0XHRcdGxldCB0b2NUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0XHRcdFx0dG9jVGl0bGUuc2V0QXR0cmlidXRlKCdjbGFzcycsJ3diLXRvYy10aXRsZScpO1xuXHRcdFx0XHR0b2NUaXRsZS5pbm5lckhUTUwgPSB2YWwuZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRvYycpO1xuXHRcdFx0XHR2YWwuYXBwZW5kQ2hpbGQodG9jVGl0bGUpO1xuXHRcdFx0fVxuXHRcdFx0bGV0IGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuXHRcdFx0bGlzdC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnd2ItdG9jLWxpc3QnKTtcblx0XHRcdHRoaXMuX3NlY3Rpb25zLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdGlmKCF2YWwuY2xhc3NOYW1lLm1hdGNoKC93Yi1uby10b2MvKSkge1xuXHRcdFx0XHRcdGxldCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0XHRcdFx0XHRpdGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCd3Yi10b2MtaXRlbScpO1xuXHRcdFx0XHRcdGxldCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXHRcdFx0XHRcdGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgJyMnICsgdmFsLmlkKTtcblx0XHRcdFx0XHRsaW5rLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnd2ItbGluaycpO1xuXHRcdFx0XHRcdGxldCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcblx0XHRcdFx0XHR0aXRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnd2ItdG9jLWl0ZW0tdGl0bGUnKTtcblx0XHRcdFx0XHR0aXRsZS5pbm5lckhUTUwgPSB2YWwudGl0bGU7XG5cdFx0XHRcdFx0bGV0IHBhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cdFx0XHRcdFx0dGl0bGUuc2V0QXR0cmlidXRlKCdjbGFzcycsJ3diLXRvYy1pdGVtLXBhZ2UtbnVtYmVyJyk7XG5cdFx0XHRcdFx0cGFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItZWxlbWVudC1wYWdlLW51bWJlcicsIHZhbC5pZCk7XG5cdFx0XHRcdFx0bGluay5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cdFx0XHRcdFx0bGluay5hcHBlbmRDaGlsZChwYWdlKTtcblx0XHRcdFx0XHRpdGVtLmFwcGVuZENoaWxkKGxpbmspO1xuXHRcdFx0XHRcdGxpc3QuYXBwZW5kQ2hpbGQoaXRlbSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0dmFsLmFwcGVuZENoaWxkKGxpc3QpO1xuXHRcdH0pO1xuXHR9XG5cdFxuXHRnZXRUb2NDdXJyZW50U2VjdGlvbigpIHtcblx0XHRsZXQgcG9zaXRpb24gPSAtdGhpcy5fcG9zaXRpb247XG5cdFx0dGhpcy5fdG9jcy5mb3JFYWNoICggdG9jID0+IHtcblx0XHRcdGZvcihsZXQgaT0xOyBpPHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmKHRoaXMuX3NlY3Rpb25zW2ldLm9mZnNldExlZnQtdGhpcy5fY29udGFpbmVyV2lkdGg+PXBvc2l0aW9uKSB7XG5cdFx0XHRcdFx0bGV0IGlkID0gdGhpcy5fc2VjdGlvbnNbaS0xXS5pZDtcblx0XHRcdFx0XHR0b2MucXVlcnlTZWxlY3RvckFsbCgnYScpLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdFx0XHRpZih2YWwuZ2V0QXR0cmlidXRlKCdocmVmJykucmVwbGFjZSgvXiMvLCcnKSA9PT0gaWQpIHtcblx0XHRcdFx0XHRcdFx0aWYoIXZhbC5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZS5tYXRjaCgvY3VycmVudC8pKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFsLnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lKz0nIGN1cnJlbnQnO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZih2YWwucGFyZW50RWxlbWVudC5jbGFzc05hbWUubWF0Y2goL2N1cnJlbnQvKSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhbC5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZT12YWwucGFyZW50RWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSgvIGN1cnJlbnQvLCcnKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdH1cblxuXHRpbnNlcnRCb29rbWFyaygpIHtcblx0XHRsZXQgYm9va21hcmsgPSBudWxsO1xuXHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX2VsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgZWxQb3NpdGlvbiA9IHRoaXMuX2VsZW1lbnRzW2ldLm9mZnNldExlZnQtdGhpcy5nZXRNYXJnaW5YKCk7XG5cdFx0XHRlbFBvc2l0aW9uID0gKGVsUG9zaXRpb24ldGhpcy5fY29udGFpbmVyV2lkdGghPT0wID8gZWxQb3NpdGlvbi1lbFBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIDogZWxQb3NpdGlvbik7Ly9hbHdheXMgYXQgYSBwYWdlIGJlZ2lubmluZ1xuXHRcdFx0aWYoZWxQb3NpdGlvbiA9PT0gLXRoaXMuX3Bvc2l0aW9uKVxuXHRcdFx0e1xuXHRcdFx0XHRib29rbWFyayA9IGk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZihlbFBvc2l0aW9uID4gLXRoaXMuX3Bvc2l0aW9uKVxuXHRcdFx0e1xuXHRcdFx0XHRib29rbWFyayA9IGktMTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuX2Jvb2ttYXJrID0gYm9va21hcms7XG5cdH1cblxuXHRnb1RvQm9va21hcmsoYm9va21hcmspIHtcblx0XHRsZXQgZWxlbWVudCA9IHRoaXMuX2VsZW1lbnRzW3RoaXMuX2Jvb2ttYXJrXTtcblx0XHQvL3Bvc2l0aW9uIDogb2Zmc2V0TGVmdCBvZiBlbGVtZW50IHJlbGF0aXZlIHRvIHRleHRcblx0XHRsZXQgcG9zaXRpb24gPSBlbGVtZW50Lm9mZnNldExlZnQtdGhpcy5nZXRNYXJnaW5YKCk7XG5cdFx0cG9zaXRpb24gPSAocG9zaXRpb24ldGhpcy5fY29udGFpbmVyV2lkdGghPT0wID8gcG9zaXRpb24tcG9zaXRpb24ldGhpcy5fY29udGFpbmVyV2lkdGggOiBwb3NpdGlvbik7Ly9hbHdheXMgYXQgYSBwYWdlIGJlZ2lubmluZ1xuXHRcdC8vdGV4dCBwb3NpdGlvbiA9IC1wb3NpdGlvblxuXHRcdHRoaXMuX3RleHQuc3R5bGUubGVmdCA9IC1wb3NpdGlvbiArIFwicHhcIjtcblx0XHR0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3RleHQub2Zmc2V0TGVmdDtcblx0XHR0aGlzLnJlZnJlc2goKTtcblx0fVxuXG5cdHJlZnJlc2goKSB7XG5cdFx0dGhpcy5pbnNlcnRCb29rbWFyaygpO1xuXG5cdFx0aWYodGhpcy5jb2w9PT1mYWxzZSkge1xuXHRcdFx0XG5cdFx0XHR0aGlzLl9jdXJyZW50UGFnZXMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdFx0dmFsLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5fdG90YWxQYWdlcy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLl9jdXJyZW50VG90YWxQYWdlcy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aGlzLl9lbFBhZ2VOdW1iZXJzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdHZhbC5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuX3NlY3Rpb25UaXRsZXMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdFx0dmFsLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRcblx0XHRcdHRoaXMuZ2V0UGFnZVN0YXJ0KCk7XG5cdFx0XHRcblx0XHRcdGlmKHRoaXMuX3RvY3MubGVuZ3RoIT09MCkge1xuXHRcdFx0XHR0aGlzLmdldFRvY0N1cnJlbnRTZWN0aW9uKCk7XG5cdFx0XHR9XHRcblx0XHRcdFxuXHRcdFx0dGhpcy5fY3VycmVudFBhZ2VzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdGlmKHZhbC5pbm5lckhUTUwhPXRoaXMuZ2V0UGFnZU51bWJlcigpKSB7XG5cdFx0XHRcdFx0dmFsLmlubmVySFRNTCA9IHRoaXMuZ2V0UGFnZU51bWJlcigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5fdG90YWxQYWdlcy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHRpZih2YWwuaW5uZXJIVE1MIT10aGlzLmdldFRvdGFsUGFnZXMoKSkge1xuXHRcdFx0XHRcdHZhbC5pbm5lckhUTUwgPSB0aGlzLmdldFRvdGFsUGFnZXMoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuX2N1cnJlbnRUb3RhbFBhZ2VzLmZvckVhY2goIHZhbCA9PiB7XG5cdFx0XHRcdGlmKHRoaXMuZ2V0UGFnZU51bWJlcigpIDwgMSkge1xuXHRcdFx0XHRcdHZhbC5pbm5lckhUTUwgPSBcIiZlbXNwOyZlbXNwO1wiO1xuXHRcdFx0XHR9IGVsc2UgaWYodmFsLmlubmVySFRNTCE9PSB0aGlzLmdldFBhZ2VOdW1iZXIoKSArIFwiL1wiICsgdGhpcy5nZXRUb3RhbFBhZ2VzKCkpIHtcblx0XHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gdGhpcy5nZXRQYWdlTnVtYmVyKCkgKyBcIi9cIiArIHRoaXMuZ2V0VG90YWxQYWdlcygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5fZWxQYWdlTnVtYmVycy5mb3JFYWNoKCB2YWwgPT4ge1xuXHRcdFx0XHRsZXQgaWQgPSB2YWwuZ2V0QXR0cmlidXRlKCdkYXRhLXdiLWVsZW1lbnQtcGFnZS1udW1iZXInKTtcblx0XHRcdFx0bGV0IHBhZ2VOdW1iZXIgPSB0aGlzLmVsZW1lbnRQYWdlTnVtYmVyKGlkKTtcblx0XHRcdFx0aWYocGFnZU51bWJlciA8IDEpIHtcblx0XHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdFx0fSBlbHNlIGlmKHZhbC5pbm5lckhUTUwhPXBhZ2VOdW1iZXIpIHtcblx0XHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gcGFnZU51bWJlcjtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuX3NlY3Rpb25UaXRsZXMuZm9yRWFjaCggdmFsID0+IHtcblx0XHRcdFx0aWYodmFsLmlubmVySFRNTCE9PXRoaXMuZ2V0U2VjdGlvblRpdGxlKCkpIHtcblx0XHRcdFx0XHR2YWwuaW5uZXJIVE1MID0gdGhpcy5nZXRTZWN0aW9uVGl0bGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR9XG5cdH1cbn1cblxuIl19
