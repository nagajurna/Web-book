function Book(a,b,c,d){"use strict";this.bookContainer=a,this.container=b,this.text=c,this.height=d.height,this.width=d.width,this.marginX=d.marginX,this.marginY=d.marginY,this.position=0,this.col=null,this.lastBreak=document.createElement("div"),this.lastBreak.className="text-break",this.text.appendChild(this.lastBreak),this.lastElement=document.createElement("div"),this.lastElement.innerHTML="&nbsp;",this.lastElement.className="wb-section",this.text.appendChild(this.lastElement),this.sections=this.text.getElementsByClassName("wb-section"),this.breaks=this.text.getElementsByClassName("text-break"),"WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style?this.toBook():this.toScroll();for(var e=this.bookContainer.getElementsByClassName("wb-link"),f=0;f<e.length;f++)e[f].addEventListener("click",function(a){if(this.col===!0){a.preventDefault();var b=a.target.href,c=b.replace(/^.+#/,""),d=document.getElementById(c),e=d.offsetLeft-this.getMarginX();e=e%this.containerWidth!==0?e-e%this.containerWidth:e,this.text.style.left=-e+"px",this.position=-e,this.refresh()}}.bind(this),!1)}Book.prototype.toBook=function(){"use strict";if("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style){this.col=!0;var a,b=this.container.style,c=this.text.style;for(b.position="relative",b.padding="0px",b.height=this.getHeight()+"px",b.maxWidth=this.getWidth()+"px",this.containerWidth=this.container.clientWidth,a=0;a<this.sections.length;a++)"10%"!==this.sections[a].style.minHeight&&(this.sections[a].style.minHeight="10%");for(a=0;a<this.breaks.length;a++)"300%"!==this.breaks[a].style.marginBottom&&(this.breaks[a].style.marginBottom="300%");if("300%"!==this.lastElement.style.marginBottom&&(this.lastElement.style.marginBottom="300%"),c.position="absolute",c.left=0,c.boxSizing="border-box",c.height="100%",c.width="100%",c.paddingRight=this.getMarginX()+"px",c.paddingLeft=this.getMarginX()+"px",c.paddingTop=this.getMarginY()+"px",c.paddingBottom=this.getMarginY()+"px",c.WebkitColumnWidth=this.containerWidth+"px",c.MozColumnWidth=this.containerWidth+"px",c.columnWidth=this.containerWidth+"px",c.MozColumnGap=2*this.getMarginX()+"px",c.WebkitColumnGap=2*this.getMarginX()+"px",c.ColumnGap=2*this.getMarginX()+"px","MozColumnWidth"in document.body.style){b.overflow="visible";var d=this.bookContainer.getElementsByClassName("wb-element-page-number"),e=[];for(a=0;a<d.length;a++){var f=d[a].getAttribute("data-wb");e.push(this.elementPageNumber(f))}for(this.position=this.text.offsetLeft,a=0;a<d.length;a++)d[a].innerHTML=e[a],d[a].style.display="inline"}b.overflow="hidden",this.bookmark&&(this.goToBookmark(this.bookmark),this.position=this.text.offsetLeft),this.refresh()}},Book.prototype.toScroll=function(){"use strict";this.col=!1;var a=this.container.style,b=this.text.style;a.height="auto",a.maxWidth=this.getWidth()+"px",a.overflow="visible",b.position="static",b.height="auto",a.paddingRight=this.getMarginX()+"px",a.paddingLeft=this.getMarginX()+"px",a.paddingTop=this.getMarginY()+"px",a.paddingBottom=this.getMarginY()+"px",("WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style)&&(b.WebkitColumns="auto 1",b.MozColumns="auto 1",b.columns="auto 1");var c;for(c=0;c<this.sections.length;c++)this.sections[c].style.minHeight="0";for(c=0;c<this.breaks.length;c++)this.breaks[c].style.marginBottom="0";this.lastElement.style.marginBottom="0px",this.refresh()},Book.prototype.setWidth=function(a){return this.width=a,this},Book.prototype.getWidth=function(){return this.width},Book.prototype.setHeight=function(a){return this.height=a,this},Book.prototype.getHeight=function(){return this.height},Book.prototype.setMarginX=function(a){return this.marginX=a,this},Book.prototype.getMarginX=function(){return this.marginX},Book.prototype.setMarginY=function(a){return this.marginY=a,this},Book.prototype.getMarginY=function(){return this.marginY},Book.prototype.forward=function(){"use strict";this.lastElement.offsetLeft+this.position>this.containerWidth+this.getMarginX()&&(this.position-=this.containerWidth,this.text.style.left=this.position+"px",this.refresh())},Book.prototype.backward=function(){"use strict";this.position<0&&(this.position+=this.containerWidth,this.text.style.left=this.position+"px",this.refresh())},Book.prototype.tofirstPage=function(){"use strict";this.position<0&&(this.position=0,this.text.style.left=this.position+"px",this.refresh())},Book.prototype.tolastPage=function(){"use strict";this.lastElement.offsetLeft+this.position>this.containerWidth+this.getMarginX()&&(this.position=this.containerWidth+this.getMarginX()-this.lastElement.offsetLeft,this.text.style.left=this.position+"px",this.refresh())},Book.prototype.getPageNumber=function(){"use strict";var a=this.position,b=-a/this.containerWidth+1;return b},Book.prototype.totalPages=function(){"use strict";var a=Math.floor(this.lastElement.offsetLeft/this.containerWidth);return a},Book.prototype.goToPage=function(a){"use strict";a=a<1?1:a,a=a>this.totalPages()?this.totalPages():a;var b=this.containerWidth*(a-1);this.text.style.left=-b+"px",this.position=this.text.offsetLeft,this.refresh()},Book.prototype.elementPageNumber=function(a){"use strict";var b=document.getElementById(a),c=b.offsetLeft-this.getMarginX();c=c%this.containerWidth!==0?c-c%this.containerWidth:c;var d=c/this.containerWidth+1;return d},Book.prototype.sectionTitle=function(){"use strict";for(var a,b=-this.position,c=1;c<this.sections.length;c++)if(this.sections[c].offsetLeft-this.containerWidth>=b){var d=this.sections[c-1].id;a=void 0!==d&&this.getPageNumber()===this.elementPageNumber(d)?"":this.sections[c-1].title;break}return a},Book.prototype.insertBookmark=function(){"use strict";for(var a=this.text.querySelectorAll("*"),b={},c=0;c<a.length;c++){var d=a[c].offsetLeft-this.getMarginX();if(d=d%this.containerWidth!==0?d-d%this.containerWidth:d,d===-this.position){b.element=a[c],b.index=c;break}if(d>-this.position){b.element=a[c-1],b.index=c-1;break}}return b},Book.prototype.goToBookmark=function(a){"use strict";var b=this.text.querySelectorAll("*"),c=b[a.index],d=c.offsetLeft-this.getMarginX();d=d%this.containerWidth!==0?d-d%this.containerWidth:d,this.text.style.left=-d+"px",this.position=this.text.offsetLeft,this.refresh()},Book.prototype.refresh=function(){"use strict";var a,b=this.bookContainer,c=b.getElementsByClassName("wb-current-page"),d=b.getElementsByClassName("wb-total-pages"),e=b.getElementsByClassName("wb-currentByTotal-pages"),f=b.getElementsByClassName("wb-element-page-number"),g=b.getElementsByClassName("wb-current-section-title");if(this.col===!1){for(a=0;a<c.length;a++)c[a].style.display="none";for(a=0;a<d.length;a++)d[a].style.display="none";for(a=0;a<e.length;a++)e[a].style.display="none";for(a=0;a<f.length;a++)f[a].style.display="none";for(a=0;a<g.length;a++)g[a].style.display="none"}else{for(this.bookmark=this.insertBookmark(),a=0;a<c.length;a++)c[a].innerHTML=this.getPageNumber(),c[a].style.display="inline-block";for(a=0;a<d.length;a++)d[a].innerHTML=this.totalPages(),d[a].style.display="inline-block";for(a=0;a<e.length;a++)e[a].innerHTML=this.getPageNumber()+"/"+this.totalPages(),e[a].style.display="inline-block";if("MozColumnWidth"in document.body.style);else for(a=0;a<f.length;a++){var h=f[a].getAttribute("data-wb");f[a].innerHTML=this.elementPageNumber(h),f[a].style.display="inline-block"}for(a=0;a<g.length;a++)g[a].innerHTML=this.sectionTitle(),g[a].style.display="inline-block"}};